LAMMPS (20 Nov 2019)
# Compute elastic constant tensor for a crystal at finite temperature
#
# WARNING: This script attempts to measure small differences in
# statistical averages generated by finite temperature MD simulations.
# This creates many more opportunities for errors to occur, compared
# to the zero temperature version provided in examples/ELASTIC.
# Hence, it is always a good idea to start with the zero temperature
# calculation, before attempting to use this script.
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, MD parameters, deformation parameters,
#		  and initial configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the MD sampling of stress components
#  is generating accurate statistical averages.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to
#  check for finite size effects.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 5.0e-2

# metal units, elastic constants in GPa
##### units		metal

## metal to real conversion !
## 1 bar ~ 1 atm
## 1 eV  = 23.061 kcal/mol

variable cfac equal 1.0e-4

variable cunits string GPa

# Define MD parameters
variable nevery equal 20                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 20*${nrepeat} 
variable nfreq equal 20*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 200           
variable nequil equal 20*${nthermo}       # length of equilibration run
variable nequil equal 20*200       
variable nrun equal 10*${nthermo}          # length of equilibrated run
variable nrun equal 10*200          
variable timestep equal 1.0	           # timestep



units           real
boundary        p p p

newton          off
pair_style      lj/charmmfsw/coul/long 10 12
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
pair_modify     mix arithmetic
kspace_style    pppm 1e-6

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmmfsw
special_bonds   charmm
improper_style  harmonic

read_data       sys_after_npt.data
  orthogonal box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713)
  1 by 2 by 2 MPI processor grid
  reading atoms ...
  2565 atoms
  reading velocities ...
  2565 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  reading bonds ...
  1710 bonds
  reading angles ...
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000337842 secs
  read_data CPU = 0.0112686 secs
change_box	all triclinic
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)



# Compute initial state

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284191
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000266004
  estimated relative force accuracy = 8.01046e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton off
      pair build: half/nsq/newtoff
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 11.05 | 11.15 | 11.44 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    208.29218   -8327.9902    22239.333            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     200    256.70951   -8304.8009    25482.534    25278.946    25901.671    25320.177   -244.87015   -523.47107   -158.90622    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     400    289.11071   -8098.6818    22782.861    24613.684     24436.65    24395.115    458.79916   -691.36574    348.20286    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     600    301.37226   -7891.3841    15947.748    19397.508     19294.59    19509.047   -189.64151    367.21945    380.73985    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     800    302.03429   -7844.2227    7369.7517    11519.527    11343.804    11722.219   -232.14628    351.18693    468.35531    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1000    304.50763    -7912.394    2342.4464    4284.4043    4877.7923    4884.4398    494.09489   -44.207876    919.54515    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1200    297.60203   -7924.2185   -988.14321    471.17525    501.19918    -176.1853    72.555573   -27.592511    286.78418    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1400     303.3289   -8028.1981   -4193.2394   -4044.2137   -3223.7991   -2671.5633    553.70058    5.2100662    198.18788    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1600    295.30753   -7946.5216   -5544.2038   -5205.2353   -6096.0983   -5484.4681    268.93766   -5.4110413   -62.813088    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1800    303.26994    -8037.973   -6249.5149   -5834.9007   -6403.9919   -5669.0478    520.66436    109.59875    48.711879    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2000    289.32214   -8004.2821   -5298.6288   -5739.4292   -5970.1182    -6408.042    495.64399    138.45017    392.68107    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2200    297.40285   -7898.8446   -6142.4142   -6807.2244   -6577.0552   -5858.6242   -71.789711    47.421436    3.8593458    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2400      291.722    -7860.953    -5618.191   -6024.5202   -4557.6029   -6038.3714   -289.83429    261.02212   -56.794814    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2600    293.78552   -7894.1862   -4118.2132   -4953.9186   -5055.7833   -3957.1325    503.65266   -35.745567    374.71543    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2800    301.12474   -7873.7637    -3516.288   -3803.8948   -4068.5094   -3320.8886   -221.30463    662.67669   -336.73416    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3000    299.72824   -7958.3131   -2609.9764   -2591.1836   -4110.5592   -2754.3964   -699.76282    496.54104   -645.50575    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3200    305.07666   -7992.8632   -1650.6688   -2134.5987   -2431.3402    -1915.868    265.34923    610.69334    211.47705    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3400    297.72322   -7972.6712   -332.36025   -1103.4997   -1163.8207   -1880.9944   -545.94504     7.586486     4.028767    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3600    290.18452   -8023.8119    3.7945994   -193.92174   -704.56563    74.388477    233.57517   -359.16837   -27.943595    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3800    305.39735   -8039.2634    458.68375   -414.77277    695.25254   -820.66933    432.08649     -658.836   -489.16038    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    4000    310.92241   -8047.3377    716.85145    165.28426   -499.99869    750.34842    767.34924   -720.43673    170.51038    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
Loop time of 62.8086 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.502 ns/day, 4.362 hours/ns, 63.686 timesteps/s
97.9% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.871     | 39.672     | 40.423     |   8.8 | 63.16
Bond    | 0.12589    | 0.12653    | 0.12723    |   0.1 |  0.20
Kspace  | 10.689     | 11.408     | 12.194     |  16.0 | 18.16
Neigh   | 10.677     | 10.679     | 10.681     |   0.0 | 17.00
Comm    | 0.68342    | 0.6886     | 0.69319    |   0.5 |  1.10
Output  | 0.00068274 | 0.0008099  | 0.0011821  |   0.0 |  0.00
Modify  | 0.14869    | 0.17735    | 0.20247    |   5.3 |  0.28
Other   |            | 0.05609    |            |       |  0.09

Nlocal:    641.25 ave 655 max 626 min
Histogram: 1 1 0 0 0 0 0 0 0 2
Nghost:    8595.75 ave 8685 max 8509 min
Histogram: 1 0 0 0 1 1 0 0 0 1
Neighs:    488188 ave 501286 max 474973 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1952753
Ave neighs/atom = 761.307
Ave special neighs/atom = 2
Neighbor list builds = 473
Dangerous builds = 0


include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284191
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000266004
  estimated relative force accuracy = 8.01046e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 11.43 | 11.44 | 11.44 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    310.92241   -8047.3377    716.85145            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     200    299.69574   -8074.3127   -273.67342    61.582219    110.14318   -213.24484    -296.2343   -43.510587     33.01658    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     400    291.42096   -7990.9419    1323.2725    344.22645    732.89097    513.79652   -195.65031    755.46711   -500.60183    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     600    305.08624   -7998.9554    1039.2584    631.70138    831.13174    354.53535    256.52721   -806.43398    634.09522    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     800    300.59804   -7950.3742    117.44074   -115.02369     27.67684    1714.6562    65.579779   -463.05449   -329.83627    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1000    293.57059   -7965.0812   -160.33956     1038.422    69.694908    477.27789    294.68467    323.83967    598.30274    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1200    305.25731   -7956.0631    1816.5306     712.9755    1720.2314    1588.5963    253.83979    531.70532    -1015.252    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1400    301.04024   -8013.9396    2156.6666    2542.7608    3051.0547    1817.4169    46.413195    79.219914    15.018271    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1600    305.41441    -8034.474    3165.5743    2762.1148    2409.2015    1749.8626   -285.64463     589.5419    694.54927    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1800    289.59933   -8013.5182    1116.7041    2581.3784    1681.5752    2923.5636    706.35397   -594.13958    628.80172    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2000    300.04885   -8002.0122    1308.7422    1767.1397    1004.9302    945.45833    78.085579    429.20125    207.91058    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
Loop time of 31.1432 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.549 ns/day, 4.325 hours/ns, 64.219 timesteps/s
97.9% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.429     | 19.821     | 20.04      |   5.4 | 63.64
Bond    | 0.062645   | 0.063298   | 0.063682   |   0.2 |  0.20
Kspace  | 5.3067     | 5.5285     | 5.9295     |  10.4 | 17.75
Neigh   | 5.2757     | 5.2764     | 5.2774     |   0.0 | 16.94
Comm    | 0.34345    | 0.34605    | 0.34839    |   0.4 |  1.11
Output  | 0.00033563 | 0.0004064  | 0.00061071 |   0.0 |  0.00
Modify  | 0.072722   | 0.079721   | 0.084563   |   1.8 |  0.26
Other   |            | 0.02787    |            |       |  0.09

Nlocal:    641.25 ave 656 max 615 min
Histogram: 1 0 0 0 0 0 1 0 1 1
Nghost:    8651.25 ave 8696 max 8614 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    487772 ave 499376 max 469960 min
Histogram: 1 0 0 0 0 0 1 1 0 1

Total # of neighbors = 1951090
Ave neighs/atom = 760.659
Ave special neighs/atom = 2
Neighbor list builds = 234
Dangerous builds = 0

variable pxx0 equal f_avp[1]
variable pyy0 equal f_avp[2]
variable pzz0 equal f_avp[3]
variable pxy0 equal f_avp[4]
variable pxz0 equal f_avp[5]
variable pyz0 equal f_avp[6]

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 29.4259070715506
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 29.4259070715506
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 29.4259070715506

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-1767.13974649654)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-1767.13974649654)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-1004.93016442811)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-1004.93016442811)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-945.458326799268)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-945.458326799268)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-207.910583302626)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-207.910583302626)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-429.201252897224)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-429.201252897224)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-78.0855785110352)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-78.0855785110352)/(v_delta/v_len0)*0.0001

# Write restart
write_restart restart.equil
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284191
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000266004
  estimated relative force accuracy = 8.01046e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 29.4259070715506
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000243732 secs
  read_restart CPU = 0.000968975 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.05*${len0}
variable delta equal -0.05*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.05*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.05*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -1.47129535357753 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -1.47129535357753 xy delta -0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -1.47129535357753 xy delta -0 xz delta -0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (13.2417 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (13.2417 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (13.2417 14.713 14.713) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.285003
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000255207
  estimated relative force accuracy = 7.6853e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.69 | 10.69 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7502.0304    34476.223            0            0            0            0            0            0    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     200    301.02593   -7849.2243    22159.026    26840.801    23856.594    25272.108    91.093086   -593.25822    1144.8297    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     400    296.55049   -8117.3273    18256.835    21464.365    19578.058    19078.159   -92.512085   -299.93254    58.893972    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     600    295.92953   -8151.6907    15017.699    16215.605    15974.073    17845.611    162.97004    101.01644   -152.87994    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     800    306.69153   -8175.5294    13211.457     14542.81    14103.744    11895.349   -271.63553    145.86847    170.62605    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1000    292.97221   -8201.9873    11593.687    12536.476    11829.848    12742.083   -224.92258    313.75122    -174.2123    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1200     303.9619   -8240.9596    9605.8405    9923.6441    10785.776    10328.301   -239.43568    459.36334    873.29588    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1400    305.39819   -8216.4793    7521.4201    8320.0106     8508.051    8446.5391    840.17539   -151.11349    390.40321    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1600    291.84795   -8202.0073    5586.2154    6113.8317    7084.5106    6925.7448    824.32604   -1.1885853    762.88695    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1800    298.99425   -8163.2599    5569.1977     6391.845    5460.8388    5640.6992   -680.37836   -741.06711    5.2212936    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2000    301.37552    -8183.732    4393.5049    4497.0996    4649.3546    4031.3452   -472.07277    477.24734   -386.02112    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2200    290.82818   -8173.6498    3157.5345    3121.9874    3678.5336    3995.1387    336.77862   -1088.6763    55.690748    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2400    304.45457   -8185.1227    2666.3115     2501.497    3253.8973    2748.9156    418.61398   -470.25526    69.965046    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2600     297.4669   -8226.4944    2686.4971    1811.5975    1746.1124    3540.2951    562.39044   -490.90679   -7.7628831    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2800    298.07953   -8173.3863    2706.1975    3316.2321    1956.8912    1332.3461    -76.32026    536.41267    478.41115    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3000    300.18639   -8184.4905    1971.0898    1517.1842    2835.3403    2591.1589   -219.63523   -27.891028   -402.95301    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3200    297.80065   -8268.2668    403.14866    2206.0013    418.40674    1378.9661    623.50577    697.00393    235.32464    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3400    304.12008   -8223.8601    421.67252    772.56434    417.59845    829.68734   -162.34629   -368.09953    323.47972    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3600    296.19558   -8158.4273     1077.405   -401.05209    273.04787    621.90747    -563.7742   -37.515387    36.376337    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3800    309.16474   -8099.3411    1084.9828    1152.4034    843.97578    853.87776    196.22426   -120.30993    540.25078    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    4000    304.98481   -8114.8471    716.55445    1386.9042   -262.09179    595.39046   -631.73173   -1255.0357   -257.60661    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
Loop time of 68.4122 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.052 ns/day, 4.751 hours/ns, 58.469 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.236     | 30.975     | 31.595     |   9.2 | 45.28
Bond    | 0.13031    | 0.13324    | 0.1365     |   0.7 |  0.19
Kspace  | 11.521     | 12.123     | 12.844     |  14.4 | 17.72
Neigh   | 23.556     | 23.557     | 23.557     |   0.0 | 34.43
Comm    | 1.364      | 1.3869     | 1.4069     |   1.3 |  2.03
Output  | 0.00070427 | 0.00084682 | 0.0012573  |   0.0 |  0.00
Modify  | 0.12683    | 0.12714    | 0.12743    |   0.1 |  0.19
Other   |            | 0.1095     |            |       |  0.16

Nlocal:    641.25 ave 650 max 636 min
Histogram: 2 0 0 0 1 0 0 0 0 1
Nghost:    8797.5 ave 8853 max 8761 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:    312406 ave 318212 max 309201 min
Histogram: 2 0 0 1 0 0 0 0 0 1

Total # of neighbors = 1249622
Ave neighs/atom = 487.182
Ave special neighs/atom = 2
Neighbor list builds = 448
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.285003
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000255207
  estimated relative force accuracy = 7.6853e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.69 | 10.69 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    304.98481   -8114.8471    716.55445            0            0            0            0            0            0    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     200    302.53488   -8228.3372   -543.86608   -561.90515    1694.2679   -631.89648    116.76826    367.27555    136.58436    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     400    295.98788   -8204.8963    127.18689   -224.35846   -250.64033   -469.71205    -283.9853   -270.16147    107.61963    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     600    305.23479   -8179.5285   -1666.9136    5.0100466   -477.43353   -1851.2467   -578.58718    162.77436   -245.09884    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     800    289.95753   -8204.2314   -2487.8702   -2344.8272   -2444.2693   -802.82764    402.87163   -50.499247    755.17528    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1000     302.8295   -8200.2735   -785.57346   -2504.8467   -1157.8711   -343.50907    68.112527   -590.21017    118.37011    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1200    298.14476    -8205.027   -1478.0679    -1326.418   -2383.3394   -853.23568    6.1720186    848.80171   -186.18156    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1400    294.10094   -8274.0906   -1038.8807    -863.2672   -1316.0233   -1137.2045   -181.84095    878.96922    171.67822    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1600    303.49673   -8274.3322   -735.65525   -166.84935   -1765.4038   -268.35983   -239.88205   -740.86206    -51.41901    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1800    301.04748   -8148.3475   -729.33566   -218.66306   -953.59903   -32.624482    843.92163    171.46253    1082.3512    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2000    310.01679   -8212.8582   -587.53528   -530.24069   -1429.5083    202.31832    593.62725      119.188    -414.7287    27.954612    29.425907    29.425907   -14.712954    13.241658   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
Loop time of 33.7448 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.121 ns/day, 4.687 hours/ns, 59.268 timesteps/s
97.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 15.107     | 15.339     | 15.622     |   4.7 | 45.46
Bond    | 0.065226   | 0.065976   | 0.066752   |   0.3 |  0.20
Kspace  | 5.5955     | 5.8709     | 6.0892     |   7.3 | 17.40
Neigh   | 11.675     | 11.676     | 11.676     |   0.0 | 34.60
Comm    | 0.65452    | 0.67385    | 0.68781    |   1.6 |  2.00
Output  | 0.00035213 | 0.00042761 | 0.00064966 |   0.0 |  0.00
Modify  | 0.062495   | 0.063864   | 0.065351   |   0.4 |  0.19
Other   |            | 0.05504    |            |       |  0.16

Nlocal:    641.25 ave 656 max 612 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8858.75 ave 8964 max 8737 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:    312274 ave 321659 max 294988 min
Histogram: 1 0 0 0 0 0 0 1 1 1

Total # of neighbors = 1249096
Ave neighs/atom = 486.977
Ave special neighs/atom = 2
Neighbor list builds = 222
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -4.59476086778635
variable C2neg equal ${d2}
variable C2neg equal -4.86887689256748
variable C3neg equal ${d3}
variable C3neg equal -1.48628001339118
variable C4neg equal ${d4}
variable C4neg equal -1.24527857578626
variable C5neg equal ${d5}
variable C5neg equal -0.620026506485458
variable C6neg equal ${d6}
variable C6neg equal 1.03108334961494

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000240427 secs
  read_restart CPU = 0.00100091 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.05*${len0}
variable delta equal 0.05*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.05*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.05*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 1.47129535357753 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 1.47129535357753 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 1.47129535357753 xy delta 0 xz delta 0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (16.1842 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (16.1842 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (16.1842 14.713 14.713) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28324
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000280735
  estimated relative force accuracy = 8.45404e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.28 | 10.28 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7422.9146   -27099.974            0            0            0            0            0            0    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     200    305.08275   -7695.8781   -19954.478   -24301.242   -20265.013   -21634.464   -381.95637   -201.53054   -13.943038    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     400    298.12542   -7912.6927   -14960.415   -18557.667   -16672.063   -17303.696    487.85174   -374.36775   -204.56755    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     600    291.87059   -7984.3568   -13253.464   -13053.228   -14832.396   -14734.122    -410.9196    452.63738   -813.21918    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     800    294.45947   -8018.7896   -10646.271   -11758.898   -11296.623   -11290.098   -383.61981   -348.98439   -559.50656    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1000    302.83739   -7982.9458   -9348.6952   -9578.4256   -9901.6972   -9700.6894    117.14706    279.36672   -18.623831    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1200    304.76264   -7885.5737   -8274.7335   -7484.3841   -9138.6528   -9715.9409   -6.6956204    -933.8108    351.61376    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1400    297.83412   -7973.5166    -7109.414   -7085.0905   -6915.4457   -6245.2949   -373.75539    8.4865901   -498.94171    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1600    303.09569   -7973.7665   -6032.8962   -6183.9937   -6062.6557   -5676.7618   -353.98581   -256.11593    635.29368    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1800    294.33002   -8019.0328   -4317.4199   -4758.8479   -5036.4214   -4499.2629   -371.40867     226.2051    -584.4698    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2000    301.48292    -8036.037   -3972.0145   -4106.3494   -4411.3257   -4524.4668   -1010.4329    570.16597    279.20761    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2200    296.71806   -8075.5052   -2587.5943   -3820.9899   -2668.8398    -3534.447    162.88454   -683.09809   -260.54268    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2400    295.22394   -8047.4292   -2231.9066   -2064.5934   -2867.8597   -3180.8536    3.6227254    329.11257    575.47898    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2600    300.30459   -8000.2451   -2383.6247   -2521.3336   -1072.9593   -3617.8866    42.765114   -307.14288    76.985364    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2800    296.84626   -8048.6923   -2546.7419   -1310.3301   -2327.5945   -2711.5267   -762.72215    22.007646    247.04262    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3000    296.75362    -8097.869    -2764.035   -2763.6982   -1431.2852   -2213.9993   -241.32113   -454.00168   -470.41185    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3200    299.20651   -8012.4725   -1622.9134   -2671.2972   -2661.0091   -1403.9769   -1030.3015   -317.59006   -118.73181    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3400    297.64753   -8004.2066   -1076.1866   -1655.2398   -1357.7441   -1255.1627   -428.72819    288.13495   -489.24815    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3600    294.88665   -8012.4555   -1674.6876   -1480.4215   -2313.5205   -376.52706   -914.07844    96.782035    171.75475    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    3800    303.19375   -7975.9843   -1063.9442   -663.79627   -702.33751   -1651.6459    100.15955   -152.46557   -261.71175    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    4000    296.38249    -8047.873   -487.64461   -647.05339   -500.57281   -915.07029   -826.89347   -36.272945   -11.709073    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
Loop time of 63.6455 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.430 ns/day, 4.420 hours/ns, 62.848 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 27.419     | 27.777     | 28.163     |   5.9 | 43.64
Bond    | 0.12853    | 0.13413    | 0.13761    |   1.0 |  0.21
Kspace  | 11.799     | 12.18      | 12.571     |   9.0 | 19.14
Neigh   | 22.013     | 22.013     | 22.014     |   0.0 | 34.59
Comm    | 1.2801     | 1.3072     | 1.3261     |   1.6 |  2.05
Output  | 0.00070091 | 0.00082807 | 0.0011938  |   0.0 |  0.00
Modify  | 0.12741    | 0.12847    | 0.12953    |   0.3 |  0.20
Other   |            | 0.1045     |            |       |  0.16

Nlocal:    641.25 ave 670 max 624 min
Histogram: 2 0 0 0 1 0 0 0 0 1
Nghost:    8394.75 ave 8439 max 8357 min
Histogram: 2 0 0 0 0 0 0 0 1 1
Neighs:    282638 ave 295874 max 274690 min
Histogram: 2 0 0 0 1 0 0 0 0 1

Total # of neighbors = 1130550
Ave neighs/atom = 440.76
Ave special neighs/atom = 2
Neighbor list builds = 442
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28324
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000280735
  estimated relative force accuracy = 8.45404e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.57 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    296.38249    -8047.873   -487.64461            0            0            0            0            0            0    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     200      302.513   -7981.6433    777.14998    842.28497    994.58552   -448.77446   -74.486538    -253.8199   -449.52318    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     400    298.46256   -7966.2021    140.89097    574.36655    -315.4972   -252.18529    648.92546   -196.13894   -585.34156    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     600    291.10731   -8028.6557   -168.92094   -340.19522    1188.7827    374.88887    292.95245    111.65042    58.482521    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
     800    301.80323   -8080.4744    -70.14119   -466.89485    908.94674    750.50036   -456.63895    420.67757    312.37848    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1000    308.17881   -8025.6776    386.41286   -109.19428    -514.1643   -408.79565    45.585222    336.27556   -33.757047    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1200    303.86002   -8082.2342   -454.53241    27.953557   -142.03917   -1280.5977   -173.41894   -279.04304     201.5041    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1400    301.94937   -8004.6885   -1012.9669   -586.64198   -955.71104   -90.755758    99.500617    161.60995    382.43916    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1600     303.2162    -7956.132   -134.61552   -1435.5996    -824.1314   -803.27338    200.83314    380.06951   -578.60596    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    1800    297.60261   -8008.2494   -1575.9449   -741.98484   -944.74404   -1346.3728    354.73885   -643.83501    317.54857    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
    2000    299.78039   -7966.9119   -176.30155   -994.22635   -524.06247    69.464521   -264.57394    342.20508   -124.45761    30.897202    29.425907    29.425907   -14.712954    16.184249   -14.712954    14.712954   -14.712954    14.712954            0            0            0 
Loop time of 32.1768 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.370 ns/day, 4.469 hours/ns, 62.157 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.675     | 14.017     | 14.696     |  10.8 | 43.56
Bond    | 0.064965   | 0.067763   | 0.071491   |   1.0 |  0.21
Kspace  | 5.5849     | 6.2223     | 6.5468     |  15.3 | 19.34
Neigh   | 11.077     | 11.078     | 11.079     |   0.0 | 34.43
Comm    | 0.63204    | 0.67238    | 0.69102    |   2.9 |  2.09
Output  | 0.00035479 | 0.00041668 | 0.00059976 |   0.0 |  0.00
Modify  | 0.064623   | 0.06568    | 0.066852   |   0.4 |  0.20
Other   |            | 0.05325    |            |       |  0.17

Nlocal:    641.25 ave 656 max 630 min
Histogram: 1 0 1 0 0 1 0 0 0 1
Nghost:    8445.5 ave 8480 max 8408 min
Histogram: 1 0 1 0 0 0 0 0 1 1
Neighs:    282550 ave 290887 max 275883 min
Histogram: 1 0 0 1 1 0 0 0 0 1

Total # of neighbors = 1130200
Ave neighs/atom = 440.624
Ave special neighs/atom = 2
Neighbor list builds = 222
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -7966.91189179396
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -176.301554646821
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1571.11838658609
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 882.345932065715
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 159.867790579907
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 381.677768905387
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 48.4343387465275
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1261.23435122579

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 6.67651626616526
variable C2pos equal ${d2}
variable C2pos equal 0.24516846472479
variable C3pos equal ${d3}
variable C3pos equal 1.57118107243872
variable C4pos equal ${d4}
variable C4pos equal -2.10664753584633
variable C5pos equal ${d5}
variable C5pos equal 0.761533828301393
variable C6pos equal ${d6}
variable C6pos equal -0.607184380788704

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-4.59476086778635+${C1pos})
variable C11 equal 0.5*(-4.59476086778635+6.67651626616526)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-4.86887689256748+${C2pos})
variable C21 equal 0.5*(-4.86887689256748+0.24516846472479)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-1.48628001339118+${C3pos})
variable C31 equal 0.5*(-1.48628001339118+1.57118107243872)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-1.24527857578626+${C4pos})
variable C41 equal 0.5*(-1.24527857578626+-2.10664753584633)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.620026506485458+${C5pos})
variable C51 equal 0.5*(-0.620026506485458+0.761533828301393)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(1.03108334961494+${C6pos})
variable C61 equal 0.5*(1.03108334961494+-0.607184380788704)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 29.4259070715506
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000263751 secs
  read_restart CPU = 0.0010752 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.05*${len0}
variable delta equal -0.05*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.05*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.05*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -1.47129535357753 yz delta ${deltayz} remap units box
change_box all y delta 0 -1.47129535357753 yz delta -0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 13.2417 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 13.2417 14.713) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.285003
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000255207
  estimated relative force accuracy = 7.6853e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.69 | 10.7 | 10.7 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7521.0056    33116.752            0            0            0            0            0            0    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     200    297.55068   -7825.0841    20705.126    23444.489    25568.695    23802.253   -198.98412    58.420661    940.56814    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     400    294.50801   -8069.4795    17600.609    19378.019     19088.81    19080.066    242.28296     237.4647   -246.85786    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     600    296.34835   -8225.0756    14521.324    17580.358     14778.69    16561.324    176.52315   -188.08825   -141.55186    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     800    299.06559   -8156.9562    12542.877    12553.721     14243.66     13022.56   -115.14591   -165.58265    205.17662    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1000     294.6276   -8058.0438    10789.815    11456.783    11403.074    10792.311    637.47575    797.31838      61.6283    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1200    305.48994   -8209.0366    8207.0969    9334.3994    9809.2013    9935.3332   -1034.5623   -691.24011    555.39583    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1400    291.55684    -8153.485    6281.9363    7484.2094    6920.2005    6970.9105    207.06395     -304.379   -123.32345    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1600      306.911   -8153.6238    4433.9637    5980.5394    6070.6871    5004.6912   -1223.0834    587.34117    -688.9227    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1800     293.7255   -8122.6385     3110.984    3375.1245    4077.7359    4125.4919   -255.73743   -399.59219    639.80602    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    2000    292.86248   -8186.1179    2809.9525    3546.4278    2857.0812    2205.1195    354.95972    969.67762   -175.62584    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    2200       305.25   -8190.7284    2401.3257      1760.38    2850.3804    3252.0667    350.26871   -9.2620347    8.4853121    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    2400    303.09764   -8186.1339    2223.6232    4144.0909    1713.9503    2128.7746   -477.24899   -1446.9805    1.4980098    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    2600    292.50933   -8196.5315    1995.4237    1495.7098    1370.6552    1874.3158    656.42921   -247.80948   -199.19235    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    2800    298.78482   -8186.1363    1192.3598    1088.7849    2224.6787     1329.651   -217.72512   -107.80184   -81.017671    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    3000    301.86698   -8257.5484    922.55247    871.96809    435.62296    1800.7563   -698.74297    193.95591    270.67346    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    3200    300.12216   -8307.7211    1023.2845    1057.8711    1728.5701    1011.8641   -54.388646   -297.51316    503.52947    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    3400     288.1711   -8092.8433    6.2804341   -185.00217    564.72271    330.30957    185.31231   -188.42423   -457.03452    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    3600    310.55693   -8245.8929    235.07238   -38.659358   -181.83325    1592.9202     559.4508    511.26353     44.97325    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    3800     300.3684   -8266.0362    293.95985   -576.42558   -899.49104    667.10644   -177.54664   -349.38803   -41.530705    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    4000    296.45457   -8171.3415    286.78059   -667.18214    241.05278    723.74678   -33.367722    475.12822    121.64812    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
Loop time of 70.0102 on 4 procs for 4000 steps with 2565 atoms

Performance: 4.936 ns/day, 4.862 hours/ns, 57.134 timesteps/s
97.7% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.309     | 31.085     | 31.8       |  18.5 | 44.40
Bond    | 0.13234    | 0.13692    | 0.13919    |   0.7 |  0.20
Kspace  | 12.562     | 13.248     | 14.966     |  27.4 | 18.92
Neigh   | 23.853     | 23.854     | 23.854     |   0.0 | 34.07
Comm    | 1.4134     | 1.4423     | 1.4986     |   2.8 |  2.06
Output  | 0.00074183 | 0.00089052 | 0.0013222  |   0.0 |  0.00
Modify  | 0.13028    | 0.13103    | 0.13152    |   0.1 |  0.19
Other   |            | 0.1119     |            |       |  0.16

Nlocal:    641.25 ave 659 max 626 min
Histogram: 1 1 0 0 0 0 0 1 0 1
Nghost:    8896.25 ave 8975 max 8814 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Neighs:    312324 ave 323186 max 303471 min
Histogram: 2 0 0 0 0 0 0 1 0 1

Total # of neighbors = 1249297
Ave neighs/atom = 487.055
Ave special neighs/atom = 2
Neighbor list builds = 446
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.285003
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000255207
  estimated relative force accuracy = 7.6853e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.69 | 10.7 | 10.7 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    296.45457   -8171.3415    286.78059            0            0            0            0            0            0    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     200    294.26569    -8214.085   -392.81123   -115.44109   -1243.3455    354.96405   -159.52429    42.574902    122.37533    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     400     294.8775   -8247.9533   -999.30649   -1637.6767   -122.70534   -1179.1068   -65.174081    558.67648   -1010.0587    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     600    304.35605   -8204.5819   -686.67834   -967.14188   -2008.7537   -538.42757    98.818788    396.08388    52.085379    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
     800     301.2344   -8167.0772   -1167.7521   -885.28425   -943.40755    -489.5209   -888.02808    338.48799   -312.12392    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1000    294.83061    -8104.788   -1201.8029   -31.918408   -854.66726   -1154.5876   -181.75361   -410.90068   -325.70434    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1200    301.31431   -8237.0581   -1293.4872   -1647.5764   -560.74344   -573.17621   -801.37689   -82.537586    682.94124    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1400    311.28322   -8165.2549   -869.38161   -832.73235   -1114.1624   -469.85825    903.67034   -401.04578   -359.00904    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1600    297.41519   -8169.0063   -838.68576   -718.58067     -1507.81    58.112471   -682.70593   -309.29743    483.62671    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    1800    295.94375   -8169.7036   -410.52649    59.347691   -250.85424    -1122.414   -113.21627   -299.40428    141.24365    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
    2000    302.51933   -8100.1894    615.34368   -697.65418    228.51262   -17.837599    212.69743    370.31567   -95.393056    29.425907    27.954612    29.425907   -14.712954    14.712954   -14.712954    13.241658   -14.712954    14.712954            0            0            0 
Loop time of 36.7894 on 4 procs for 2000 steps with 2565 atoms

Performance: 4.697 ns/day, 5.110 hours/ns, 54.363 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 15.18      | 16.219     | 17.23      |  18.0 | 44.09
Bond    | 0.071346   | 0.072064   | 0.073259   |   0.3 |  0.20
Kspace  | 6.3477     | 7.3304     | 8.3414     |  26.0 | 19.93
Neigh   | 12.313     | 12.314     | 12.315     |   0.0 | 33.47
Comm    | 0.70249    | 0.73085    | 0.75868    |   2.4 |  1.99
Output  | 0.00036825 | 0.00044454 | 0.00065251 |   0.0 |  0.00
Modify  | 0.067008   | 0.067646   | 0.068302   |   0.2 |  0.18
Other   |            | 0.0554     |            |       |  0.15

Nlocal:    641.25 ave 655 max 625 min
Histogram: 1 0 0 0 1 0 0 1 0 1
Nghost:    8963.75 ave 9045 max 8894 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    312432 ave 321243 max 303265 min
Histogram: 1 0 0 1 0 0 1 0 0 1

Total # of neighbors = 1249727
Ave neighs/atom = 487.223
Ave special neighs/atom = 2
Neighbor list builds = 225
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -4.92958785156634
variable C2neg equal ${d2}
variable C2neg equal -1.55283507910931
variable C3neg equal ${d3}
variable C3neg equal -1.92659185186399
variable C4neg equal ${d4}
variable C4neg equal -0.606607278757968
variable C5neg equal ${d5}
variable C5neg equal -0.117771168780708
variable C6neg equal ${d6}
variable C6neg equal 0.269223705185364

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000263105 secs
  read_restart CPU = 0.00105358 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.05*${len0}
variable delta equal 0.05*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.05*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.05*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 1.47129535357753 yz delta ${deltayz} remap units box
change_box all y delta 0 1.47129535357753 yz delta 0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 16.1842 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 16.1842 14.713) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28324
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000280735
  estimated relative force accuracy = 8.45404e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.27 | 10.28 | 10.28 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885    -7462.096    -25988.94            0            0            0            0            0            0    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     200    301.03088   -7688.1595   -18807.452   -20739.835   -22507.099   -20406.815   -85.943657   -336.34984    101.63971    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     400    292.94802   -7860.1275   -15062.104   -15957.329   -18050.679   -17121.167   -121.60972   -275.67985   -510.93548    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     600    291.16126   -7952.0715   -12591.576   -14028.845    -12479.01   -13968.159   -332.23195    530.28755   -396.86602    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     800    298.48346   -7930.0079   -10799.989   -10957.952   -11562.295   -11196.898    39.581731   -8.3919502   -1098.1996    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1000    304.77092    -7868.424   -8005.7172   -10139.495   -9419.8671   -10421.425    147.59786     20.78715    25.427458    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1200    302.76099   -7963.5438   -6423.6606   -7029.3539   -7284.4622   -8106.3855    359.72914    444.69913   -117.88725    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1400    294.21157   -7979.5157   -6182.8897    -6221.125   -7141.9898   -5659.9481   -310.00573   -219.34595      -959.65    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1600    294.89405   -8041.2449   -5115.5512   -5858.1038   -5344.4149   -4674.1643    -315.1522   -128.73859   -382.54656    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1800    301.53229   -7998.6722   -3378.1001    -4664.267   -4265.8309   -3836.3954   -445.93714   -206.27492    170.34507    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    2000    292.21747   -7968.1769    -5106.178   -5189.6868   -2930.2953   -4592.1478     52.14463   -250.67192   -66.144183    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    2200     303.0353   -8035.4797   -2772.7825   -3277.0238   -4090.5085   -3261.1125    -170.1831   -233.79746   -84.969219    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    2400    304.79346   -8070.6663   -2054.3157   -2296.9175   -2991.5878   -2845.8623   -411.86365   -397.64906   -142.47361    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    2600    293.88945    -8004.191   -2176.8572   -2985.7252    -2128.127   -1982.1589    178.57273   -134.61024    -252.5514    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    2800    304.08284   -7951.3631    -2367.608   -2704.2132   -2392.7695   -2553.5999   -311.69704    112.63897   -326.15001    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    3000    290.61114   -7953.4832   -570.76007   -1270.4728    -1358.208   -1198.5108     520.0029   -109.15831    254.33218    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    3200    300.84594   -8013.0027   -81.308627   -1442.5976   -626.19493   -626.71301   -447.92686    456.98272    19.016016    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    3400    302.71927   -8007.5351   -750.50503    87.258998   -355.73842   -995.58282    429.80803    589.39361   -517.34335    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    3600    293.45564   -8048.7408    39.487443   -225.15168   -295.75819   -695.54094    274.68627    -360.7744   -627.93659    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    3800    296.38681   -8095.4243   -450.56077    195.90453   -1296.3149    -405.6595    36.372643    21.454344    710.41905    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    4000    304.85268   -8023.4099   -1037.6513   -736.38069   -341.98169   -1518.5692   -504.27931   -489.96346   -15.339057    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
Loop time of 65.7151 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.259 ns/day, 4.564 hours/ns, 60.869 timesteps/s
97.7% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 27.26      | 28.196     | 29.758     |  17.7 | 42.91
Bond    | 0.1331     | 0.13597    | 0.13746    |   0.5 |  0.21
Kspace  | 11.759     | 13.249     | 14.162     |  24.7 | 20.16
Neigh   | 22.556     | 22.557     | 22.557     |   0.0 | 34.32
Comm    | 1.2681     | 1.3355     | 1.3682     |   3.4 |  2.03
Output  | 0.00070893 | 0.00084413 | 0.0012325  |   0.0 |  0.00
Modify  | 0.13321    | 0.13386    | 0.13529    |   0.2 |  0.20
Other   |            | 0.1069     |            |       |  0.16

Nlocal:    641.25 ave 651 max 623 min
Histogram: 1 0 0 0 0 0 1 0 0 2
Nghost:    8346.5 ave 8371 max 8307 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Neighs:    282647 ave 287272 max 274604 min
Histogram: 1 0 0 0 0 1 0 0 0 2

Total # of neighbors = 1130589
Ave neighs/atom = 440.775
Ave special neighs/atom = 2
Neighbor list builds = 446
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28324
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000280735
  estimated relative force accuracy = 8.45404e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.56 | 10.66 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    304.85268   -8023.4099   -1037.6513            0            0            0            0            0            0    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     200    298.78341   -8074.3667    38.689366   -440.29475   -1526.1452    582.41466    347.33035    69.111627   -469.89248    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     400    298.27783   -8081.5893   -800.16153   -1222.3231    513.83876   -1340.8672    102.11955   -39.194179   -158.51593    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     600    295.84154   -8036.9175   -1353.6657   -1275.8506   -425.20841   -447.59663    419.73992    218.37852   -12.325648    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
     800    301.03958   -7970.9044   -1532.1331     -1017.61   -1292.5225     -3291.95    103.34409    385.37398   -389.88111    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1000    296.15848   -8029.7313   -2199.5566   -681.89316   -1674.3728   -1871.0362   -44.422609    108.57251    965.64328    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1200    298.66275   -7992.3963   -1724.6267   -1306.0332   -1244.7359   -2372.1611    146.96416    14.531437    20.453937    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1400    304.71927   -8062.6704   -1744.9058    -1705.982   -2000.2793   -1572.0649   -148.50567   -46.647567    39.740284    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1600    293.74282   -8014.3511   -1189.0475   -1908.9848   -1769.5878    -679.3614    130.22778    -462.5329    107.55528    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    1800    301.48617   -8068.1968   -757.25424   -1006.2611   -1271.3534   -848.80375   -276.23594   -172.19992   -372.93928    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
    2000    304.83966   -8056.5781   -198.33589   -1246.7926   -94.786169   -158.53609    254.06824   -155.54688    35.420839    29.425907    30.897202    29.425907   -14.712954    14.712954   -14.712954    16.184249   -14.712954    14.712954            0            0            0 
Loop time of 32.7119 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.282 ns/day, 4.543 hours/ns, 61.140 timesteps/s
97.7% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.58      | 14.162     | 15.019     |  14.3 | 43.29
Bond    | 0.066159   | 0.067267   | 0.06782    |   0.3 |  0.21
Kspace  | 5.6912     | 6.5218     | 7.0759     |  20.3 | 19.94
Neigh   | 11.176     | 11.177     | 11.178     |   0.0 | 34.17
Comm    | 0.63982    | 0.6655     | 0.69168    |   2.3 |  2.03
Output  | 0.00034563 | 0.00041914 | 0.00063271 |   0.0 |  0.00
Modify  | 0.063038   | 0.064714   | 0.066356   |   0.6 |  0.20
Other   |            | 0.05333    |            |       |  0.16

Nlocal:    641.25 ave 649 max 636 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Nghost:    8294.75 ave 8315 max 8283 min
Histogram: 1 1 0 1 0 0 0 0 0 1
Neighs:    282607 ave 286788 max 279139 min
Histogram: 1 1 0 0 0 0 1 0 0 1

Total # of neighbors = 1130428
Ave neighs/atom = 440.713
Ave special neighs/atom = 2
Neighbor list builds = 222
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8056.57806634295
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -198.335891606937
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -308.765157415361
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -172.753240389851
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -113.489277015605
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -221.619491693162
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 565.945764232814
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 348.910069215707

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 4.1518098078238
variable C2pos equal ${d2}
variable C2pos equal 2.35536680963592
variable C3pos equal ${d3}
variable C3pos equal 2.11789520762975
variable C4pos equal ${d4}
variable C4pos equal -0.281998971826162
variable C5pos equal ${d5}
variable C5pos equal -0.27348902267118
variable C6pos equal ${d6}
variable C6pos equal 0.599410140408394

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-4.92958785156634+${C1pos})
variable C12 equal 0.5*(-4.92958785156634+4.1518098078238)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-1.55283507910931+${C2pos})
variable C22 equal 0.5*(-1.55283507910931+2.35536680963592)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-1.92659185186399+${C3pos})
variable C32 equal 0.5*(-1.92659185186399+2.11789520762975)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-0.606607278757968+${C4pos})
variable C42 equal 0.5*(-0.606607278757968+-0.281998971826162)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-0.117771168780708+${C5pos})
variable C52 equal 0.5*(-0.117771168780708+-0.27348902267118)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.269223705185364+${C6pos})
variable C62 equal 0.5*(0.269223705185364+0.599410140408394)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 29.4259070715506
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000249729 secs
  read_restart CPU = 0.00101131 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.05*${len0}
variable delta equal -0.05*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.05*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.05*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 13.2417) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.285003
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000255207
  estimated relative force accuracy = 7.6853e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.7 | 10.71 | 10.71 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7475.0195    34768.732            0            0            0            0            0            0    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     200    304.74131   -7871.0475    21999.139    25058.219     24624.69     26776.36    293.52738   -511.65919    639.44496    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     400    288.59442   -8051.6446    18413.081    19104.332    20175.901    19940.068      257.535   -81.328709   -9.9337537    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     600    298.38696   -8108.4784    16106.442    17328.542    17714.471    16617.049   -36.175954   -64.452929   -51.459718    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     800    301.64655   -8104.1269    14749.964    15686.548    14533.903    16274.354    -102.6016   -101.51192   -553.98577    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1000    298.66817   -8199.5848    12573.572    12896.505     13983.29    13626.568   -106.53035   -685.31595    190.93642    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1200    301.23333   -8106.3559    11004.409    12647.407     11459.85    10520.918    2.5909404   -162.08972    5.5612628    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1400     297.1022   -8152.7796    8991.3592    10198.518    10315.492      9770.14   -515.73045    297.40384    165.78084    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1600    293.71623   -8150.0053    8011.6135    8062.0196     7480.791    8153.8208   -53.472403   -825.40816   -87.159911    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1800    297.17259   -8186.3202    5808.6769    6261.5825     6617.384    6958.7288    -1023.068    281.32746    440.40507    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    2000    300.52854   -8097.4785    5044.1995    5060.5452    5645.3342    6482.4919    153.39196   -108.27996   -175.17794    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    2200    300.76269   -8218.0079      3207.84    3221.4586    2967.8232    3923.1556    473.57323   -240.73585    226.49853    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    2400    301.55747   -8189.0066    1848.7607    2425.7341    2789.9015    2340.4867    -20.79187    276.84883   -698.49692    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    2600    302.12909   -8141.7691    2056.7109    2215.6413    692.85086    2566.9527    470.25537    889.47112   -153.24865    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    2800    306.24781   -8188.4767    855.94717    1218.1269    1289.9231     1019.081   -377.75381    387.90681    -71.72081    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    3000    298.18097   -8196.0846    1222.0875    827.91135    1588.3688    1483.7435    278.87131    -260.3625    295.26615    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    3200    298.49828   -8117.9574    539.46271    142.18942    928.06488    1846.5304   -514.70156   -230.10161    -408.4451    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    3400    306.13762   -8213.1494    993.69818    1609.4061    992.39463    1081.3794    617.83814     392.6951    82.747048    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    3600    299.34905   -8196.7788   -639.45606    151.89674   -847.47878   -59.468225    452.16436   -646.11451   -580.11697    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    3800    302.99283    -8160.365   -629.50236   -1216.4752   -830.54954   -1692.2069   -185.40059    71.263698    26.006145    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    4000    297.79061   -8170.5462    -1040.619    -1418.569   -1515.0508   -628.23489   -141.71161    233.47551    545.84376    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
Loop time of 67.1313 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.148 ns/day, 4.662 hours/ns, 59.585 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.295     | 30.12      | 30.523     |   9.0 | 44.87
Bond    | 0.13033    | 0.13284    | 0.13428    |   0.4 |  0.20
Kspace  | 11.482     | 11.861     | 12.644     |  13.6 | 17.67
Neigh   | 23.419     | 23.42      | 23.422     |   0.0 | 34.89
Comm    | 1.3378     | 1.3605     | 1.3988     |   2.1 |  2.03
Output  | 0.00070514 | 0.00085046 | 0.0012676  |   0.0 |  0.00
Modify  | 0.12436    | 0.12899    | 0.13341    |   1.0 |  0.19
Other   |            | 0.107      |            |       |  0.16

Nlocal:    641.25 ave 660 max 623 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Nghost:    8897.5 ave 8967 max 8860 min
Histogram: 1 1 1 0 0 0 0 0 0 1
Neighs:    312415 ave 323106 max 301194 min
Histogram: 1 0 1 0 0 0 0 1 0 1

Total # of neighbors = 1249660
Ave neighs/atom = 487.197
Ave special neighs/atom = 2
Neighbor list builds = 447
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.285003
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000255207
  estimated relative force accuracy = 7.6853e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.7 | 10.71 | 10.71 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    297.79061   -8170.5462    -1040.619            0            0            0            0            0            0    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     200    295.43821   -8200.9511    -702.8573   -1502.6823   -973.00269   -1357.4077    715.99749   -293.15176    436.99892    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     400    294.49557   -8201.8499     428.2935   -116.42138   -719.99879   -223.94657    252.10184    171.62054   -364.94141    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     600    303.87488   -8178.6872    698.97037    696.84649   -934.73514    72.063833    309.80496   -887.87971   -5.5789784    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
     800    294.59976   -8245.2655   -487.88264    275.12619    -217.8153    -263.3877   -566.33747     729.9361    539.04765    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1000    302.53392   -8248.5687   -465.98652   -748.80468    55.203532    399.51895    152.57237    384.51428    474.33349    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1200    305.48063   -8149.2381   -369.99604    63.068812   -1096.2246   -480.91377    521.39854    216.71183   -364.45308    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1400    306.57222   -8173.0155   -183.84368   -728.25165    412.51872    131.86709   -539.76421     577.7245   -226.66578    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1600    297.37528   -8204.0267    469.61366    322.70327   -1077.5741    1123.7932   -41.768531   -917.91044    -631.0274    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    1800    294.62815   -8149.8816    882.71674   -347.44474    501.93413    89.736856    477.07729   -115.75984    489.09735    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
    2000    294.08375   -8078.4652    1123.9028     1279.241    732.07627    1016.8006    153.11827    86.248227    434.25626    29.425907    29.425907    27.954612   -14.712954    14.712954   -14.712954    14.712954   -14.712954    13.241658            0            0            0 
Loop time of 34.0198 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.079 ns/day, 4.725 hours/ns, 58.789 timesteps/s
97.4% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.762     | 15.137     | 15.436     |   6.8 | 44.50
Bond    | 0.065783   | 0.067112   | 0.068259   |   0.4 |  0.20
Kspace  | 5.8772     | 6.166      | 6.5253     |  10.2 | 18.12
Neigh   | 11.838     | 11.839     | 11.839     |   0.0 | 34.80
Comm    | 0.6829     | 0.69251    | 0.70542    |   1.1 |  2.04
Output  | 0.0003482  | 0.00042027 | 0.00062708 |   0.0 |  0.00
Modify  | 0.061396   | 0.064252   | 0.066901   |   0.9 |  0.19
Other   |            | 0.05368    |            |       |  0.16

Nlocal:    641.25 ave 649 max 637 min
Histogram: 2 0 0 1 0 0 0 0 0 1
Nghost:    8896 ave 8929 max 8851 min
Histogram: 1 0 0 0 0 1 0 1 0 1
Neighs:    312372 ave 316462 max 310012 min
Histogram: 2 0 0 1 0 0 0 0 0 1

Total # of neighbors = 1249488
Ave neighs/atom = 487.13
Ave special neighs/atom = 2
Neighbor list builds = 223
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.97579740106628
variable C2neg equal ${d2}
variable C2neg equal -0.545707781739248
variable C3neg equal ${d3}
variable C3neg equal 0.142684489737304
variable C4neg equal ${d4}
variable C4neg equal 0.452691349012356
variable C5neg equal ${d5}
variable C5neg equal -0.685906052181353
variable C6neg equal ${d6}
variable C6neg equal 0.150065374867954

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000254913 secs
  read_restart CPU = 0.00105625 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.05*${len0}
variable delta equal 0.05*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.05*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.05*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 16.1842) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28324
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000280735
  estimated relative force accuracy = 8.45404e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.27 | 10.27 | 10.27 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7423.9394   -27457.313            0            0            0            0            0            0    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     200    300.37861   -7664.3928   -19344.564   -21941.175   -20870.554   -23306.912   -470.48202    452.65464    107.86254    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     400     293.9481   -7844.0615   -16798.217   -17219.491   -17362.675   -18907.648   -190.33043    420.78535   -273.75645    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     600    297.22797   -7965.2543   -15171.961   -16407.315   -16535.023   -14824.526   -229.85878    493.27703   -345.37278    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     800    296.86924    -7965.246   -12622.785   -13722.203   -12450.773   -14669.866    398.67441   -348.84385   -178.15523    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1000    300.98206   -7922.6846   -9783.1135   -10703.834   -10810.165   -11039.478   -122.58221   -111.35294    306.45456    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1200    300.37481   -7974.6784   -9117.5565   -9459.6881    -9521.859   -8872.8057   -808.47577   -221.80361   -979.47873    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1400    298.14506   -8020.1277    -7106.752   -6910.6417   -8363.6006   -7909.3607    45.434454    127.51989    144.84677    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1600    300.25715   -7987.2774   -5258.4973   -7059.1785   -6375.0759   -5450.2954    624.81179   -513.35346    185.53057    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1800    303.11061   -7935.8281   -3781.6434   -4496.5148   -4497.6405    -4051.729   -400.21913    676.28222    344.19665    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    2000    299.71682   -8026.1902   -3541.7688   -3680.2482   -2837.7072   -3954.5011    326.83008    338.36312   -16.859054    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    2200     298.9986   -7949.9433   -1567.9917   -2311.8849   -3182.0644   -2767.7437    532.98581    772.06681    357.62066    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    2400     302.8005   -8072.1075   -1674.2176   -1451.5613   -1634.3775   -1633.4227    -797.7181   -374.43428    169.68082    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    2600    301.73436   -8104.5316    -1641.312   -1554.6226   -2018.2711   -2014.3893    74.447496   -524.34125    1069.1365    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    2800    301.32821   -8023.8867   -976.11891   -1244.1382   -1841.8189   -1023.4545    643.86803   -314.55582    43.700229    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    3000    298.37264   -7977.3296   -959.84414   -1551.5102     120.2145    -1037.435    19.795565   -717.36805   -1115.1512    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    3200    297.95022   -8124.4484   -274.67664   -833.28295   -1321.1597   -794.32133    485.16659    184.28231   -342.87747    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    3400    300.15694   -8073.6771   -357.29695   -751.12323   -407.78895       -396.3    117.47859   -555.62032   -202.41086    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    3600    301.41987   -7991.7184   -1167.3212    -103.4451    -1284.377   -784.73933   -202.58432   -473.58536   -816.52048    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    3800    303.53299   -7930.2517    343.79199   -1140.5472   -324.87778    171.58562   -829.08207    439.39919     11.37636    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    4000    306.08197   -8081.1385   -172.15197   -29.171696    152.68628    5.5480084   -569.72193   -112.82076    79.680166    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
Loop time of 63.8579 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.412 ns/day, 4.435 hours/ns, 62.639 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 27.322     | 27.56      | 28.08      |   5.8 | 43.16
Bond    | 0.13142    | 0.13221    | 0.13314    |   0.2 |  0.21
Kspace  | 11.808     | 12.316     | 12.537     |   8.5 | 19.29
Neigh   | 22.318     | 22.319     | 22.32      |   0.0 | 34.95
Comm    | 1.2777     | 1.299      | 1.3165     |   1.6 |  2.03
Output  | 0.0007106  | 0.00084474 | 0.0012271  |   0.0 |  0.00
Modify  | 0.12582    | 0.12705    | 0.12818    |   0.3 |  0.20
Other   |            | 0.1039     |            |       |  0.16

Nlocal:    641.25 ave 659 max 616 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8284.75 ave 8360 max 8191 min
Histogram: 1 0 0 0 0 1 1 0 0 1
Neighs:    282607 ave 291272 max 267772 min
Histogram: 1 0 0 0 0 0 1 0 1 1

Total # of neighbors = 1130428
Ave neighs/atom = 440.713
Ave special neighs/atom = 2
Neighbor list builds = 447
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28324
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000280735
  estimated relative force accuracy = 8.45404e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.65 | 10.65 | 10.66 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    306.08197   -8081.1385   -172.15197            0            0            0            0            0            0    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     200    299.51373   -8100.0212    172.09368   -340.53354   -504.17375    475.63229    842.84814   -345.66364   -1050.5727    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     400    294.83503   -8019.4061   -1379.8533   -415.11055    60.568078   -771.41702   -591.78334    156.73528     77.97229    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     600     302.3111   -7931.0102   -599.12475   -730.64062   -641.95825   -888.57564    409.80205   -105.87767   -13.176238    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
     800    296.92296   -7992.3059    -93.58266   -590.28947   -645.73442    76.058821   -490.05195    11.846997   -803.93454    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1000    306.81931   -8070.5447   -247.14123   -278.77704   -829.48632    799.40362   -71.648562    336.67824   -843.47247    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1200    303.65474   -8008.3648     614.8396   -216.31374    1206.1199   -26.750307   -844.05202   -722.73288   -103.45766    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1400    298.10018   -7989.3211    -174.8875   -99.435293    388.98253   -10.993179    537.58312    223.35183   -481.31637    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1600    289.19104   -7971.6792   -901.93213   -687.16047   -391.11008   -894.81273    274.92311   -497.73009    407.37338    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    1800    299.70096   -7940.6579   -15.781036    95.230583    41.390757   -1453.2863   -117.38503   -309.67924   -702.52881    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
    2000    301.31418    -8030.374   -1319.5789    688.69522   -746.38721   -452.43991    321.21107    -460.0198    93.211348    29.425907    29.425907    30.897202   -14.712954    14.712954   -14.712954    14.712954   -14.712954    16.184249            0            0            0 
Loop time of 32.7918 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.270 ns/day, 4.554 hours/ns, 60.991 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.521     | 13.958     | 14.746     |  13.0 | 42.57
Bond    | 0.065324   | 0.066381   | 0.067774   |   0.4 |  0.20
Kspace  | 5.8723     | 6.6388     | 7.0639     |  18.3 | 20.25
Neigh   | 11.354     | 11.355     | 11.356     |   0.0 | 34.63
Comm    | 0.63674    | 0.65886    | 0.67088    |   1.7 |  2.01
Output  | 0.00036888 | 0.00043548 | 0.00062542 |   0.0 |  0.00
Modify  | 0.06148    | 0.062635   | 0.063874   |   0.3 |  0.19
Other   |            | 0.05157    |            |       |  0.16

Nlocal:    641.25 ave 665 max 604 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Nghost:    8315.5 ave 8414 max 8201 min
Histogram: 1 1 0 0 0 0 0 0 0 2
Neighs:    282600 ave 296433 max 262483 min
Histogram: 1 0 0 0 1 0 0 0 0 2

Total # of neighbors = 1130402
Ave neighs/atom = 440.703
Ave special neighs/atom = 2
Neighbor list builds = 223
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8030.37404973625
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -1319.57890715121
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -261.361018792632
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -2182.48188624854
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -1514.89381641246
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1713.32333115104
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -200.260868490954
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1441.98923593425

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 4.05700153057834
variable C2pos equal ${d2}
variable C2pos equal 6.3748241013533
variable C3pos equal ${d3}
variable C3pos equal 4.92070428642346
variable C4pos equal ${d4}
variable C4pos equal 3.29979963847375
variable C5pos equal ${d5}
variable C5pos equal 1.25892424277636
variable C6pos equal ${d6}
variable C6pos equal -3.27047550528001

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-0.97579740106628+${C1pos})
variable C13 equal 0.5*(-0.97579740106628+4.05700153057834)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-0.545707781739248+${C2pos})
variable C23 equal 0.5*(-0.545707781739248+6.3748241013533)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(0.142684489737304+${C3pos})
variable C33 equal 0.5*(0.142684489737304+4.92070428642346)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(0.452691349012356+${C4pos})
variable C43 equal 0.5*(0.452691349012356+3.29979963847375)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-0.685906052181353+${C5pos})
variable C53 equal 0.5*(-0.685906052181353+1.25892424277636)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(0.150065374867954+${C6pos})
variable C63 equal 0.5*(0.150065374867954+-3.27047550528001)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 29.4259070715506
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000258347 secs
  read_restart CPU = 0.00101136 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.05*${len0}
variable delta equal -0.05*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.05*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.05*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 -1.4713)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284891
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000250917
  estimated relative force accuracy = 7.55612e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.3 | 10.58 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7796.1372    1406.8695            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     200    306.76203   -7968.8272    636.95471    997.63557    925.16685    359.72229   -16.658801   -269.43911    1335.3648    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     400    300.02345    -8019.377    1278.9173    313.21115    1292.8708    385.96909    806.19863   -73.385329    176.57095    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     600    294.50349   -8039.7792    1206.1739    1110.0719    1704.5464    1963.4259   -88.924675    787.96431   -1758.9984    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     800    289.28918   -8080.3761     1035.891    1150.1715     1867.552    1415.1432    142.76886    745.62328    547.29472    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1000    298.91186   -8036.2036    565.87912    1307.7269     801.1982    643.81981   -318.38075    51.192658   -208.30622    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1200    305.97323   -8006.5645    633.55324    500.52652    230.88405    1516.5996   -413.25741    410.03825   -113.58744    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1400     297.8681   -8029.5232    1609.5479    205.53085    1024.5124    1384.7162     741.7605   -386.74922     319.5082    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1600    301.89788   -8100.3975    1924.5333    1922.7584    908.06993    1066.5868    823.42524   -618.97784   -240.59528    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1800    297.20004   -8090.9576    1080.9455    2518.2114    2173.2228    706.07221    226.60377    202.14632    507.01219    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    2000     301.0482   -8138.3763    1823.8709    1017.6522    707.91222    1875.2117    785.50099   -559.01964   -308.30296    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    2200    297.41114   -8063.5113    2154.0346    2224.5323     1445.766    1591.1302   -124.93855     768.2875   -49.460747    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    2400    301.94736   -8008.7004    1287.4982    844.39289    2589.6236    1616.9326   -127.95538   -98.803337    354.81002    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    2600    305.00344   -8131.2944    1118.9846    1338.4007    1306.5832    831.23961    112.15614   -421.73683    162.61561    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    2800    296.11072   -8049.8788    820.28077    488.36478    1175.6923     895.8635   -279.37018    1262.0871    329.81399    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    3000    304.18392   -7980.7969   -132.01025   -387.53019    100.96635    1262.9882    690.12232   -654.91566    321.68239    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    3200    307.23994   -8071.7174   -8.9177652   -720.94056    533.78228    229.65875    128.90579    511.64036    -163.8879    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    3400    305.74811   -8065.5807     615.4821    150.15608    113.24301   -364.74446    645.03919    2.1944866    563.98199    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    3600    303.58746   -8195.2515    447.12837   -387.83032    683.30137   -88.510565    -282.0129    96.119175   -106.56168    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    3800    301.57749   -8148.6101    231.95512    1075.5221    372.74193    319.50624   -285.17148    494.35788    312.01277    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    4000    303.17138   -8061.9238    1163.0618    772.46363    374.49545    986.14898   -136.63127   -959.47226    11.996392    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
Loop time of 67.441 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.124 ns/day, 4.683 hours/ns, 59.311 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 28.52      | 29.28      | 30.383     |  14.0 | 43.42
Bond    | 0.13364    | 0.1351     | 0.13722    |   0.4 |  0.20
Kspace  | 11.773     | 12.839     | 13.568     |  20.3 | 19.04
Neigh   | 23.569     | 23.571     | 23.572     |   0.0 | 34.95
Comm    | 1.3346     | 1.373      | 1.4087     |   2.7 |  2.04
Output  | 0.00072174 | 0.00087796 | 0.0013058  |   0.0 |  0.00
Modify  | 0.12979    | 0.13127    | 0.13241    |   0.3 |  0.19
Other   |            | 0.1107     |            |       |  0.16

Nlocal:    641.25 ave 657 max 616 min
Histogram: 1 0 0 0 0 0 0 2 0 1
Nghost:    8670.75 ave 8741 max 8608 min
Histogram: 1 1 0 0 0 0 0 1 0 1
Neighs:    296839 ave 306248 max 282213 min
Histogram: 1 0 0 0 0 0 1 0 1 1

Total # of neighbors = 1187356
Ave neighs/atom = 462.907
Ave special neighs/atom = 2
Neighbor list builds = 456
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284891
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000250917
  estimated relative force accuracy = 7.55612e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.67 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    303.17138   -8061.9238    1163.0618            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     200    293.61736   -8097.7891    616.19062    150.17139    627.70096    1895.2263   -448.98582   -250.22252    -156.4145    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     400    304.09952   -8190.5343   -90.660424    409.59538    118.12115    470.45672    490.86008    387.17294   -40.416806    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     600    291.24047   -8050.7394   -332.02532   -1151.0367   -201.67239     158.8347    140.00798    488.17322   -448.01089    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
     800    307.00212    -8100.256   -459.37048   -211.07923   -1090.5171   -359.15715   -240.86339    272.55947   -396.87379    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1000    297.98397   -8083.8147   -149.64277    236.72031   -493.04331   -722.09478    85.017297   -366.14955   -30.173962    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1200    306.41152   -8014.4667     211.5871   -345.43719    424.34845   -375.76229     265.3108    127.20396   -537.14948    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1400    297.96795   -8053.0596   -27.355617   -265.96495    53.758306    436.03563    57.116749    100.41448   -67.400562    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1600    298.56378   -8092.6756   -716.67157    -406.3993   -964.44154   -1164.1231    703.59334    291.68987    114.19486    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    1800    292.88594   -8080.3695   -873.77784   -692.97566   -542.32359   -1043.3368    -510.2532    90.246679   -369.73479    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
    2000    298.70773   -8148.5954   -813.69178   -123.70762   -1355.8834   -1271.5591   -314.07292   -424.42258   -230.44952    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0   -1.4712954 
Loop time of 33.3681 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.179 ns/day, 4.634 hours/ns, 59.937 timesteps/s
97.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.224     | 14.5       | 14.81      |   5.8 | 43.45
Bond    | 0.064917   | 0.066548   | 0.06811    |   0.5 |  0.20
Kspace  | 6.0174     | 6.3159     | 6.5809     |   8.5 | 18.93
Neigh   | 11.697     | 11.698     | 11.698     |   0.0 | 35.06
Comm    | 0.66022    | 0.66806    | 0.67549    |   0.8 |  2.00
Output  | 0.00034956 | 0.00042613 | 0.00064887 |   0.0 |  0.00
Modify  | 0.061686   | 0.064008   | 0.06644    |   0.8 |  0.19
Other   |            | 0.05567    |            |       |  0.17

Nlocal:    641.25 ave 658 max 610 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8607.75 ave 8729 max 8499 min
Histogram: 1 0 0 0 2 0 0 0 0 1
Neighs:    296725 ave 304401 max 278251 min
Histogram: 1 0 0 0 0 0 0 0 1 2

Total # of neighbors = 1186899
Ave neighs/atom = 462.729
Ave special neighs/atom = 2
Neighbor list builds = 226
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -3.78169473990988
variable C2neg equal ${d2}
variable C2neg equal -4.72162703686084
variable C3neg equal ${d3}
variable C3neg equal -4.43403489679088
variable C4neg equal ${d4}
variable C4neg equal -0.876720202081628
variable C5neg equal ${d5}
variable C5neg equal -1.70724766571657
variable C6neg equal ${d6}
variable C6neg equal -0.784317006389235

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000271482 secs
  read_restart CPU = 0.00117636 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.05*${len0}
variable delta equal 0.05*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.05*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.05*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 1.4713)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283106
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000290941
  estimated relative force accuracy = 8.76139e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.3 | 10.58 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7830.8372    635.44813            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     200    303.46778   -7968.9626   -109.45109   -587.27999    140.93684    187.71304   -134.81385    189.63581   -329.62557    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     400    303.34108   -8071.7942    1031.5459    987.80422    720.64335    -956.3485    374.48672   -53.121079   -1160.5238    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     600    292.61888    -8037.339    715.54985    942.56148    485.91599    1907.9899    602.20334    855.55793    639.61454    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     800     299.6611   -7948.3023     1332.062     1712.235    1842.5787    845.70013    94.423304   -418.80707   -452.13654    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1000     303.9125   -8034.8785    314.69879    714.68499    342.52029    96.279596    796.09091    -690.1611    -83.06574    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1200    292.73566   -8019.3329    687.84048    162.19511    126.81395    1295.7836    241.74605    897.89702    822.85917    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1400    298.86949   -8040.9241     1425.408    519.09726    1283.0801    544.48726    25.834665    371.63982   -488.08218    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1600     298.9777   -7930.0055   -18.453849    87.657671     574.6613    364.10033   -598.47237   -192.41606    66.832981    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1800    291.27994   -7963.9916    114.73332    1126.3115    7.2873401    47.792746    95.946645    128.22116    13.082813    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    2000    307.75469   -8029.9221   -292.22787     573.9514    209.53959   -381.87439    406.91434   -606.02141    289.16471    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    2200    301.66968   -8039.0149    637.86612    772.75819    811.15167   -256.40595   -317.71088   -242.40018    35.480701    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    2400    305.71474   -8163.8075     250.8951    22.893735    706.87694    186.56964    344.64325    418.32746    193.09487    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    2600    299.83807   -8067.1074     1801.829    1501.2503    455.84901    690.51324   -192.05641   -300.42245   -633.36907    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    2800    302.38181   -8025.4105    128.75704    896.19761    1528.7761     562.9003    355.23369    687.96631   -7.3059809    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    3000    301.45534    -8110.165    1309.1613    790.12362   -117.16113    697.89088   -804.46764   -143.34215    726.05144    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    3200     290.7378   -8103.7151    242.20359    1366.9097    1473.4148    1135.8521   -1056.9426   -706.12035    -275.7625    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    3400     296.4811   -8012.8073    577.48791    148.52756    556.08943    299.15296    255.55064    549.79487   -196.96599    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    3600    294.99178   -8043.2406   -1082.0902   -672.00349   -693.44446   -1034.3511   -527.48514    20.981182    19.029287    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    3800    307.94207   -8034.4848   -145.98831   -862.03816   -552.01419    682.95838    160.61735   -1023.0405    291.44386    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    4000    303.86354   -8052.1338   -890.06366   -371.56742    301.12014   -1266.2248    255.87099   -120.21066    -257.8252    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
Loop time of 65.0301 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.314 ns/day, 4.516 hours/ns, 61.510 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 27.788     | 28.514     | 29.307     |  11.7 | 43.85
Bond    | 0.12825    | 0.13197    | 0.13537    |   0.9 |  0.20
Kspace  | 10.94      | 11.702     | 12.403     |  17.6 | 17.99
Neigh   | 23.131     | 23.132     | 23.133     |   0.0 | 35.57
Comm    | 1.2798     | 1.3161     | 1.3473     |   2.3 |  2.02
Output  | 0.00071676 | 0.00086639 | 0.0012714  |   0.0 |  0.00
Modify  | 0.12464    | 0.12822    | 0.13138    |   0.8 |  0.20
Other   |            | 0.1054     |            |       |  0.16

Nlocal:    641.25 ave 647 max 634 min
Histogram: 1 0 0 0 1 0 0 1 0 1
Nghost:    8593.25 ave 8633 max 8550 min
Histogram: 1 1 0 0 0 0 0 0 0 2
Neighs:    296854 ave 300495 max 292642 min
Histogram: 1 0 0 0 0 2 0 0 0 1

Total # of neighbors = 1187418
Ave neighs/atom = 462.931
Ave special neighs/atom = 2
Neighbor list builds = 455
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283106
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000290941
  estimated relative force accuracy = 8.76139e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.67 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    303.86354   -8052.1338   -890.06366            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     200    299.95441   -8141.5347   -1625.0556   -1518.6116   -675.64599   -644.06103   -52.060936    459.65498    424.77277    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     400    304.39942   -8139.9693   -146.74623    -96.01381   -46.042847   -1621.9405   -629.27197   -668.62508    915.20774    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     600    301.99532    -8062.458   -334.38448    336.98919   -421.96549   -636.42827    865.81037   -159.47561    495.24676    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
     800    308.41003   -8032.7545    406.73424    413.89382    -230.8204   -278.53897   -68.634026   -87.294636    116.26959    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1000    301.25966   -8098.1918   -345.87891   -430.36885    1115.4375    -98.48878   -773.62681    147.41928   -410.57685    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1200    298.22865   -8081.9869   -904.22292   -374.21005   -888.78729    -617.3017     333.4541    -205.5414   -747.25342    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1400    300.95742   -8019.0044    724.70708   -764.57453    504.48902    418.34906   -109.45219   -179.52262    176.38176    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1600    297.94699   -8038.3701    451.33741    647.56327    617.92291    713.35887   -157.25751   -452.83303   -570.48533    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    1800    295.71153   -8076.6904    986.31425    1143.4373    645.80506    831.57074    684.66518    188.76373   -408.22459    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
    2000    293.43811   -8157.7388    1025.3874    939.70389    578.29845    146.69192   -498.53512    290.24233   -580.94401    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0            0    1.4712954 
Loop time of 32.5481 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.309 ns/day, 4.521 hours/ns, 61.448 timesteps/s
97.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.995     | 14.291     | 14.618     |   5.9 | 43.91
Bond    | 0.064434   | 0.065909   | 0.067994   |   0.5 |  0.20
Kspace  | 5.6203     | 5.9272     | 6.2092     |   8.6 | 18.21
Neigh   | 11.487     | 11.488     | 11.488     |   0.0 | 35.29
Comm    | 0.63774    | 0.65757    | 0.67008    |   1.6 |  2.02
Output  | 0.0003524  | 0.0004284  | 0.00064906 |   0.0 |  0.00
Modify  | 0.06448    | 0.064826   | 0.065289   |   0.1 |  0.20
Other   |            | 0.05374    |            |       |  0.17

Nlocal:    641.25 ave 664 max 626 min
Histogram: 1 1 0 0 0 1 0 0 0 1
Nghost:    8601 ave 8680 max 8524 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296942 ave 309960 max 287436 min
Histogram: 1 1 0 0 0 1 0 0 0 1

Total # of neighbors = 1187770
Ave neighs/atom = 463.068
Ave special neighs/atom = 2
Neighbor list builds = 225
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8157.7388437612
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1025.38741994105
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 997.218218751669
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1948.72512847909
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 130.2189125924
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1546.5028254626
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1287.14328969946
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 86.4268595654661

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 1.53984305548974
variable C2pos equal ${d2}
variable C2pos equal -1.88758992810196
variable C3pos equal ${d3}
variable C3pos equal 1.63047882841374
variable C4pos equal ${d4}
variable C4pos equal 0.24296744747432
variable C5pos equal ${d5}
variable C5pos equal -1.71588407360447
variable C6pos equal ${d6}
variable C6pos equal 3.24917680794727

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-3.78169473990988+${C1pos})
variable C14 equal 0.5*(-3.78169473990988+1.53984305548974)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-4.72162703686084+${C2pos})
variable C24 equal 0.5*(-4.72162703686084+-1.88758992810196)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-4.43403489679088+${C3pos})
variable C34 equal 0.5*(-4.43403489679088+1.63047882841374)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-0.876720202081628+${C4pos})
variable C44 equal 0.5*(-0.876720202081628+0.24296744747432)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-1.70724766571657+${C5pos})
variable C54 equal 0.5*(-1.70724766571657+-1.71588407360447)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-0.784317006389235+${C6pos})
variable C64 equal 0.5*(-0.784317006389235+3.24917680794727)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 29.4259070715506
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000248453 secs
  read_restart CPU = 0.000995928 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.05*${len0}
variable delta equal -0.05*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.05*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.05*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 -1.4713 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284891
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000250917
  estimated relative force accuracy = 7.55612e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.3 | 10.58 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7794.7176    1402.8187            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     200    309.82753   -7985.3312   -26.698162   -128.39458    776.90871    382.61414   -304.66964    1221.1818    475.74796    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     400    299.15234    -8036.466    87.165575    373.44164   -66.579742   -354.10325    867.39305    739.17083   -71.401782    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     600    298.92852   -8084.3529   -265.86759    98.187274    177.29258     193.9708    -349.2037   -386.78824   -404.88109    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     800    292.84731   -8125.3122    110.96631   -185.92832    532.45535   -582.45255    384.71092    252.18469    254.02696    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1000    296.11769   -8060.9403     563.1583    698.55723     491.8084    873.26885   -447.55462    261.21995   -935.11986    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1200    303.62511    -8037.316     451.3578    1060.1263    972.90381    628.28994    395.24428    606.71431    301.41171    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1400    297.70746   -8087.7251     702.0453    338.91618    177.24482    145.07911   -286.25379   -606.49562     138.4217    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1600    293.16784     -8030.88     700.1836    1085.5088    198.87371    540.49866   -373.61219    447.27516    178.61196    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1800    302.78067   -8051.7599    748.55762   -202.92756    804.72503    964.68123   -223.51462   -6.2368314   -605.46452    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    2000    295.09624   -8067.3553   -668.91853    551.42563    509.12663   -818.37639    305.05428   -470.90846    564.89522    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    2200    292.50201   -8069.6079   -51.325046    -1025.748   -393.38078    305.11004   -261.14892   -790.96495    225.25805    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    2400    296.56877   -8034.3937   -467.95458    880.49947    38.728284   -287.17996    265.32215   -284.92025   -857.03703    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    2600    304.65102   -7988.2114    541.77631   -860.58964    400.02962    124.54344    359.98951    334.17574    324.83903    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    2800    300.28536   -8060.2222   -374.77222   -154.50993   -522.96453    758.49263   -12.020042    304.75454     25.34044    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    3000    297.60393   -8089.4828   -25.411179    165.37577   -336.56384    457.83874   -675.88759   -517.38055     349.8551    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    3200    300.29569   -8051.7939    908.96458   -481.77623   -753.80102   -183.85462    288.47314    254.48383   -43.470304    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    3400    298.85306    -8003.948   -380.02119   -507.17149    825.40335   -473.86239    290.46214   -645.74937   -582.43036    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    3600    298.49566   -8099.8528   -1446.4408   -1466.4333   -653.25209   -1093.2735   -374.51587   -667.38276    88.924556    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    3800    301.91626   -8035.6185   -895.94018   -882.18041   -385.55932    -1467.591   -279.45436    449.20239    244.80292    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    4000     301.5433   -8050.1847   -152.96074   -505.36941    -92.33024   -454.95397     291.2957    328.77002    390.08153    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
Loop time of 66.7195 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.180 ns/day, 4.633 hours/ns, 59.952 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 28.617     | 29.119     | 29.604     |   7.9 | 43.64
Bond    | 0.13296    | 0.1361     | 0.1391     |   0.7 |  0.20
Kspace  | 12.124     | 12.583     | 13.047     |  11.3 | 18.86
Neigh   | 23.28      | 23.282     | 23.284     |   0.0 | 34.90
Comm    | 1.3326     | 1.3568     | 1.3913     |   2.1 |  2.03
Output  | 0.0007309  | 0.00090857 | 0.0014234  |   0.0 |  0.00
Modify  | 0.12977    | 0.13376    | 0.13769    |   1.0 |  0.20
Other   |            | 0.1074     |            |       |  0.16

Nlocal:    641.25 ave 649 max 631 min
Histogram: 1 0 0 1 0 0 0 0 0 2
Nghost:    8594.75 ave 8613 max 8584 min
Histogram: 1 1 0 1 0 0 0 0 0 1
Neighs:    296661 ave 300863 max 291508 min
Histogram: 1 0 1 0 0 0 0 0 0 2

Total # of neighbors = 1186643
Ave neighs/atom = 462.629
Ave special neighs/atom = 2
Neighbor list builds = 452
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284891
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000250917
  estimated relative force accuracy = 7.55612e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.67 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0     301.5433   -8050.1847   -152.96074            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     200    287.14881   -8016.4984   -62.929639   -1110.2284    791.21091   -245.87022   -538.12231   -483.49372    -395.9958    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     400    294.85025   -8130.0389   -217.10136    443.09708   -1196.7745    69.191739    35.858891    333.71995     798.0539    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     600     296.9511   -8023.1591    247.26976   -1143.1365    647.67666   -79.058002    -420.7154    199.88624   -231.67749    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
     800    302.20098   -8070.5835    339.93374    751.94284    446.35346    1514.3563    672.96107    160.76896   -855.65781    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1000     300.0401   -8135.7203    171.78078   0.36973796    731.54027     1155.853   -420.28816   -119.70234   -405.31357    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1200    297.99986   -8155.1036   -606.78591    261.23128   -344.90444   -968.66192    487.52719   -64.020562   -35.539203    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1400    298.43142   -8185.1944    2061.3191    851.05275    82.834735    1692.4894    9.0102222   -562.45755   -112.18786    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1600    302.52429    -8110.911    1425.7368    1193.3838    2474.2755    1472.9089   -698.34015    173.60519    308.34351    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    1800    292.16069    -8130.025    498.14364    858.78866    316.76292    502.44337    269.61308   -643.75538    126.08354    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
    2000    302.98448   -8138.6873    43.549757    1137.1916    425.77652   -326.36939     622.2218     62.37346    242.33327    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0   -1.4712954            0 
Loop time of 35.252 on 4 procs for 2000 steps with 2565 atoms

Performance: 4.902 ns/day, 4.896 hours/ns, 56.734 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.853     | 15.274     | 15.98      |  11.5 | 43.33
Bond    | 0.071178   | 0.072123   | 0.07291    |   0.2 |  0.20
Kspace  | 6.4713     | 7.1454     | 7.5491     |  16.0 | 20.27
Neigh   | 11.924     | 11.925     | 11.926     |   0.0 | 33.83
Comm    | 0.67969    | 0.71144    | 0.73793    |   2.8 |  2.02
Output  | 0.00039706 | 0.00047884 | 0.00068787 |   0.0 |  0.00
Modify  | 0.069405   | 0.069631   | 0.069737   |   0.1 |  0.20
Other   |            | 0.05432    |            |       |  0.15

Nlocal:    641.25 ave 664 max 622 min
Histogram: 1 0 1 0 0 1 0 0 0 1
Nghost:    8614 ave 8644 max 8581 min
Histogram: 1 1 0 0 0 0 0 0 0 2
Neighs:    296756 ave 309237 max 286923 min
Histogram: 1 0 1 0 0 1 0 0 0 1

Total # of neighbors = 1187026
Ave neighs/atom = 462.778
Ave special neighs/atom = 2
Neighbor list builds = 223
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -1.2598963226234
variable C2neg equal ${d2}
variable C2neg equal -1.15830729665506
variable C3neg equal ${d3}
variable C3neg equal -2.54365543345249
variable C4neg equal ${d4}
variable C4neg equal 0.06884536654403
variable C5neg equal ${d5}
variable C5neg equal -0.733655585133674
variable C6neg equal ${d6}
variable C6neg equal 1.08827245122486

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000247068 secs
  read_restart CPU = 0.00101868 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.05*${len0}
variable delta equal 0.05*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.05*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.05*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 1.4713 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283106
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000290941
  estimated relative force accuracy = 8.76139e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.3 | 10.58 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7818.2026    661.27429            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     200    304.42234   -7969.1189   -108.64233    329.56329   -52.988932    168.30137   -24.195056    -1269.356    581.11625    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     400    296.53482   -7997.5602    619.25801    399.69601    -23.47173   -397.80882    948.20129   -1341.0098    496.96091    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     600    302.33941   -7986.7659    62.079119    248.75045    36.187915    311.80452   -55.532689    934.57816    367.17818    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     800    307.47287   -8045.4874    1033.1001    316.93361   -41.634905    385.14345    798.86584   -101.97988   -49.220085    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1000    301.90024   -8066.7366    177.29591   -202.03963    787.89241   -680.05161   -29.486904    566.63893   -21.104804    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1200     294.8039    -8095.997    281.92265    478.87957   -489.73731    148.41925    18.275952    773.58435    416.44023    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1400    301.13255   -8090.0802   -331.27397   -35.573526    211.59321   -318.42367   -554.47528   -35.240694     189.7899    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1600    301.33431   -8068.2839    14.588032   -24.438005    386.65082    1053.5464   -32.796047    339.15948    137.63215    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1800    298.20507   -8089.4747   -269.42537   -327.85912    270.69708    102.00927     70.74171   -412.21851   -427.32352    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    2000    303.49359   -8001.7989     1145.207    896.16411     124.9834    447.10241   -807.99937    605.16096    55.705717    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    2200    300.30069   -8074.2664    273.02698    1520.9506    386.80252    67.195869    179.53044   -546.41232    498.88786    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    2400    300.01577   -8043.9451    937.07625    243.97153    300.91316   -480.71927   -160.74521    372.12007   -484.66455    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    2600    298.19657   -8052.5966    1185.9759    1853.4488    1640.6415    387.68304   -300.58641   -482.89543   -632.74289    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    2800    296.12661   -8118.1489    338.13572    1641.0322   -260.22937    1027.6903   -714.96813    -351.9036   -114.99823    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    3000    309.44149   -8133.5796   -63.504005   -570.62683    625.65191    1105.7214   -298.54101   -433.09048    229.64545    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    3200     298.8457   -8138.2162   -103.83963   -319.23504   -434.42975     1299.177    417.72583   -565.81579    -39.57795    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    3400    306.90323   -8116.0996    452.78281    463.94766    144.87088    179.52707    326.20915   -118.56916   -232.28128    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    3600    297.78822   -8030.5027    799.20527    662.89867     745.4354    1492.0815    127.88196   -54.702735     63.59243    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    3800    295.18336   -8134.3756    1062.1974    1351.9845    961.93569    782.32636    13.054211    268.18765    130.86407    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    4000    296.14585   -8038.9101    521.52509    433.96047      160.618    908.83334   -158.27342   -655.41561   -148.65153    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
Loop time of 66.5592 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.192 ns/day, 4.622 hours/ns, 60.097 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 28.524     | 28.938     | 29.569     |   7.2 | 43.48
Bond    | 0.13255    | 0.13455    | 0.13646    |   0.4 |  0.20
Kspace  | 11.98      | 12.614     | 13.019     |  10.9 | 18.95
Neigh   | 23.283     | 23.285     | 23.288     |   0.0 | 34.98
Comm    | 1.3318     | 1.3519     | 1.3609     |   1.0 |  2.03
Output  | 0.00068254 | 0.00082039 | 0.0012071  |   0.0 |  0.00
Modify  | 0.1264     | 0.12745    | 0.12859    |   0.3 |  0.19
Other   |            | 0.1069     |            |       |  0.16

Nlocal:    641.25 ave 652 max 627 min
Histogram: 1 0 0 0 0 0 2 0 0 1
Nghost:    8646 ave 8753 max 8558 min
Histogram: 1 0 1 0 0 1 0 0 0 1
Neighs:    296820 ave 304925 max 287041 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187279
Ave neighs/atom = 462.877
Ave special neighs/atom = 2
Neighbor list builds = 452
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283106
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000290941
  estimated relative force accuracy = 8.76139e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.67 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    296.14585   -8038.9101    521.52509            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     200    306.98348   -8073.5645     950.2596    522.57967   -208.02151   -754.09522   -198.67357   -97.969663    396.85107    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     400    304.72144   -8050.8623    603.75177     736.1594    113.04138   -30.342712   -250.70435   -229.61687    437.73333    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     600    297.42857   -8110.0152   -967.20204   -600.19256   -947.90288    274.62501    457.38189    80.571389   -897.97639    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
     800    301.45447    -8051.452   -395.01617   -296.78239   -901.45662   -127.50417   -766.75794    40.982737   -175.76995    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1000    306.40004   -8113.6978   -649.76977     233.1421   -919.64526   -970.86277    708.45867    279.97171   -169.17391    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1200    297.26739    -8119.541   -1637.6763   -1349.3819   -889.65021   -1200.4254   -95.290151    -625.2193    606.25387    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1400    300.83638   -8126.1166    738.31328    129.06776    92.834005   -790.73173    331.07361    875.35123   -486.64612    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1600     305.5101   -8119.9426    142.80862   -416.33382    344.34283    164.13045   -415.59976   -121.11117   -172.76371    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    1800    297.10491   -8170.2245    1927.8788    929.38396    1594.9525    1585.1634   -108.43338   -164.14135   -43.497826    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
    2000    298.50752   -8126.6031    593.65548    822.38935    967.56168    931.14131    27.354359   -353.02367    250.66936    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954            0    1.4712954            0 
Loop time of 34.5897 on 4 procs for 2000 steps with 2565 atoms

Performance: 4.996 ns/day, 4.804 hours/ns, 57.821 timesteps/s
97.0% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.428     | 14.923     | 15.579     |  12.0 | 43.14
Bond    | 0.068389   | 0.070707   | 0.072269   |   0.5 |  0.20
Kspace  | 6.2014     | 6.8167     | 7.3059     |  17.0 | 19.71
Neigh   | 11.948     | 11.948     | 11.948     |   0.0 | 34.54
Comm    | 0.66876    | 0.70987    | 0.74082    |   3.1 |  2.05
Output  | 0.00037781 | 0.00044108 | 0.00061377 |   0.0 |  0.00
Modify  | 0.065469   | 0.066931   | 0.068282   |   0.4 |  0.19
Other   |            | 0.05386    |            |       |  0.16

Nlocal:    641.25 ave 656 max 629 min
Histogram: 1 0 1 0 0 1 0 0 0 1
Nghost:    8619.75 ave 8628 max 8612 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    296706 ave 304600 max 290563 min
Histogram: 1 0 1 0 0 1 0 0 0 1

Total # of neighbors = 1186823
Ave neighs/atom = 462.699
Ave special neighs/atom = 2
Neighbor list builds = 226
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8126.60305145628
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 593.655484946904
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 611.148761810862
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 676.032429559898
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 493.785263469949
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 4.08447206361642
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1146.22884793033
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 303.546275877194

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 2.31198196937136
variable C2pos equal ${d2}
variable C2pos equal 0.657795469736424
variable C3pos equal ${d3}
variable C3pos equal 0.903346126658638
variable C4pos equal ${d4}
variable C4pos equal -0.191271385149136
variable C5pos equal ${d5}
variable C5pos equal -1.43405519006621
variable C6pos equal ${d6}
variable C6pos equal 0.148002212894838

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-1.2598963226234+${C1pos})
variable C15 equal 0.5*(-1.2598963226234+2.31198196937136)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-1.15830729665506+${C2pos})
variable C25 equal 0.5*(-1.15830729665506+0.657795469736424)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-2.54365543345249+${C3pos})
variable C35 equal 0.5*(-2.54365543345249+0.903346126658638)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(0.06884536654403+${C4pos})
variable C45 equal 0.5*(0.06884536654403+-0.191271385149136)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-0.733655585133674+${C5pos})
variable C55 equal 0.5*(-0.733655585133674+-1.43405519006621)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(1.08827245122486+${C6pos})
variable C65 equal 0.5*(1.08827245122486+0.148002212894838)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 29.4259070715506

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000278571 secs
  read_restart CPU = 0.00113271 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.05*${len0}
variable delta equal -0.05*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.05*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.05*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (-1.4713 0 0)

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284891
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000250917
  estimated relative force accuracy = 7.55612e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.3 | 10.58 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7788.1193    1104.7805            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     200    308.26537   -7977.8767    130.36609    307.23721     447.7536    636.78183    1354.0107   -26.181928    454.90137    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     400    297.89401   -7997.4849   -368.40686    783.36081    340.30624     -952.784    727.36083   -840.25516    64.074579    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     600    297.64372   -8020.6458    29.217061    428.25956    334.46957    1015.9211   -1614.6856   -280.49982   -208.51023    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     800    293.76808    -8044.189    2157.9466    1476.0936    1125.4718    925.34295    1127.5499     100.6667   -549.56823    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1000    302.92445   -8006.2342    456.65453    919.34537    423.17911    1135.0082   -328.15776   -42.777816    164.88864    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1200    300.20681   -8100.0574    606.65839    1355.0719    1044.1024    1363.8198    416.51347     199.7381   -471.02918    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1400    301.10106   -8079.7476    782.46945   -300.56689    1688.2732    594.53939    14.630749   -661.71431    533.26748    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1600    302.86996    -8107.605    368.50168   -478.19973    1596.7133     373.4974    31.040499     434.4205    152.19181    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1800    291.50391    -8102.813    448.82025    559.39614    354.78387    573.72591    238.79647    269.99213    40.344423    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    2000    304.08319   -8051.1044     1800.384    1333.2787    771.83225    299.19163   -522.41379   -464.57351   -673.69064    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    2200    296.03043   -8005.8219    876.75737    343.50984    1143.4017    1016.8806    258.69054     125.8198   -270.60015    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    2400    290.78062   -8059.8772     744.5637    1636.9294    459.43235    395.83606   -1009.4643   -376.18212    129.24365    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    2600    302.01336   -8037.7909    122.38771    159.95777    920.38989    -306.3352    178.28656     315.3997   -99.393152    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    2800    301.28776   -8028.4326     -186.829   -1016.7529    233.61102    41.657252    215.94094    36.313504    138.63015    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    3000    290.64616    -8048.329   -393.12649   -971.86179   -1145.6214    626.79014   -457.34145     160.9402    112.43651    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    3200    306.92991   -8097.4352   -1228.5512   -326.33159   -1477.9198   -310.35826    221.46319    186.67747    232.25943    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    3400    301.17063   -8052.9092    -376.9524   -1279.6129   -657.79561    -370.5216   -503.41681    592.96755    294.48351    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    3600    292.85464    -8036.065   -934.40215   -656.10722   -20.126888   -783.25551   -281.10011    100.52074    297.35193    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    3800    302.53886   -7984.4959   -814.64625   -1337.5807   -821.42522   -161.84342   -105.85922   -60.664112   -362.66085    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    4000    296.83348   -8066.4201   -1369.1341   -570.69985    -1725.159   -2070.7254    515.69983    121.30652   -338.53386    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
Loop time of 69.0084 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.008 ns/day, 4.792 hours/ns, 57.964 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.473     | 30.101     | 30.49      |   7.3 | 43.62
Bond    | 0.13938    | 0.14102    | 0.14335    |   0.4 |  0.20
Kspace  | 13.008     | 13.366     | 13.966     |  10.5 | 19.37
Neigh   | 23.764     | 23.767     | 23.769     |   0.0 | 34.44
Comm    | 1.3595     | 1.3864     | 1.4138     |   1.7 |  2.01
Output  | 0.00076412 | 0.00090068 | 0.0013042  |   0.0 |  0.00
Modify  | 0.13501    | 0.13665    | 0.13875    |   0.4 |  0.20
Other   |            | 0.109      |            |       |  0.16

Nlocal:    641.25 ave 650 max 629 min
Histogram: 1 0 0 0 0 1 0 1 0 1
Nghost:    8661.5 ave 8673 max 8646 min
Histogram: 1 0 0 0 0 1 0 1 0 1
Neighs:    296767 ave 301077 max 291254 min
Histogram: 1 0 0 0 0 1 0 1 0 1

Total # of neighbors = 1187067
Ave neighs/atom = 462.794
Ave special neighs/atom = 2
Neighbor list builds = 453
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284891
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000250917
  estimated relative force accuracy = 7.55612e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.67 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    296.83348   -8066.4201   -1369.1341            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     200    293.23038   -8067.0687   -431.54113   -549.56314   -316.20985   -1735.6425   -214.59053   -580.44773    540.90828    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     400    304.16433    -8059.089   -1001.7472   -1313.2579   -1510.1743   -1794.3633    146.30264   -344.86872   -460.76442    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     600     301.7252   -8037.7744   -1126.6201   -1292.9444    -810.0025    8.9094296   -751.82313   -412.06408    759.50545    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
     800    294.78329   -8101.9245   -1252.7148   -435.77688    -1236.258     -1302.82    -212.9412    125.01537    403.82205    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1000    300.79841   -8088.2125    887.13024   -10.277763   -356.67205    464.90225   -860.76462    179.60771   -492.77449    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1200    306.46737   -8063.9156    370.69786    273.14828    1781.6269    418.72448   -232.69882   -112.22329   -250.94282    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1400    304.90522   -8082.2795   -162.75249    326.33067   -324.32228    413.67553     108.6742    984.52553    631.86582    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1600    304.19902   -8164.2915   -1006.0684   -1088.7234   -280.10732   -1144.4537    252.33732   -264.71873    63.857125    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    1800    308.16778   -8107.2768   -1364.5155   -909.87482   -1051.2989   -2340.3071    466.91473    732.64962   -40.441265    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
    2000    299.92267   -8028.9234    -2241.243    -1372.136   -2093.8948   -1654.2272    417.96977    79.650588   -239.26908    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954   -1.4712954            0            0 
Loop time of 33.5605 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.149 ns/day, 4.661 hours/ns, 59.594 timesteps/s
97.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.429     | 14.675     | 14.99      |   5.3 | 43.73
Bond    | 0.067289   | 0.069139   | 0.07055    |   0.5 |  0.21
Kspace  | 6.0126     | 6.2986     | 6.5297     |   7.4 | 18.77
Neigh   | 11.714     | 11.714     | 11.714     |   0.0 | 34.90
Comm    | 0.65636    | 0.68142    | 0.69684    |   1.9 |  2.03
Output  | 0.00037503 | 0.00044765 | 0.00063842 |   0.0 |  0.00
Modify  | 0.064719   | 0.06754    | 0.070413   |   1.0 |  0.20
Other   |            | 0.05407    |            |       |  0.16

Nlocal:    641.25 ave 659 max 628 min
Histogram: 1 1 0 0 0 1 0 0 0 1
Nghost:    8658 ave 8686 max 8617 min
Histogram: 1 0 0 0 0 1 0 1 0 1
Neighs:    296668 ave 306082 max 290696 min
Histogram: 2 0 0 0 1 0 0 0 0 1

Total # of neighbors = 1186673
Ave neighs/atom = 462.641
Ave special neighs/atom = 2
Neighbor list builds = 226
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -6.2785515400465
variable C2neg equal ${d2}
variable C2neg equal -6.1976498872769
variable C3neg equal ${d3}
variable C3neg equal -5.19937106603008
variable C4neg equal ${d4}
variable C4neg equal -0.89435932594766
variable C5neg equal ${d5}
variable C5neg equal -0.69910133033047
variable C6neg equal ${d6}
variable C6neg equal 0.679768373241986

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.0002616 secs
  read_restart CPU = 0.00104092 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

kspace_style    pppm 1e-6



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.05*${len0}
variable delta equal 0.05*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.05*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.05*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.05*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 1.47129535357753 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (1.4713 0 0)

# Run MD

run ${nequil}
run 4000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283106
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000290941
  estimated relative force accuracy = 8.76139e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
All restart file global fix info was re-assigned
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.3 | 10.58 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    300.04885   -7836.5062    1088.4955            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     200    303.95667   -7966.8121    526.77133     218.2796    647.24369   -169.61441   -1419.7053   -137.75351    524.19689    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     400    300.14517   -8048.2867    262.21729    611.96781    557.86615    350.90595    598.43182   -113.43885    16.318094    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     600     295.4037   -8006.6816    -434.1846    770.86237    68.875418    536.75835     223.8978    148.99026   -12.978612    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     800    306.12991   -8001.0048    -689.9886   -363.77149     336.6287   -275.09522   -540.55895   -346.75321   -597.20413    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1000    299.74745   -8039.7635   -457.37596   -1379.1291   -1083.6037    407.92745   -688.30783    -433.4817    -405.7951    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1200    301.09937   -8010.8907   -18.859045   -81.049587    -826.4233   -1934.8182    270.97623   -470.37735    196.57391    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1400     289.8729   -8048.4982   -291.54825   -715.59099   -1146.4002   -736.36526    -632.3366    -698.3176     96.50261    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1600    292.82394   -8026.6742   -1802.1935    -1952.055   -1632.7274   -1296.4939   -678.06506   -317.19182    592.91133    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1800    298.41004   -7996.0832   -952.73703   -1625.6542   -1931.3473   -769.01076   -102.06934    210.01091    148.43713    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    2000    303.36575     -8061.35   -1808.3604    -1167.428   -2094.6139   -1729.0621   -406.00286    325.84021    223.51492    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    2200    295.62589    -8010.819   -2011.7865   -1849.8608   -1788.8572    -2710.306   -600.64962    114.11868   -168.96767    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    2400    309.18346   -8076.8491   -1973.2769   -1543.4873   -2572.9817   -1261.9979     215.0141   -121.73094   -655.51211    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    2600    295.67774   -8033.1518   -2166.7613   -1934.1233   -1969.8996   -2816.2212    113.25314   -97.429774    582.33018    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    2800     302.6266   -8037.2158   -2330.6261   -1782.7292   -2256.1831   -2120.3364    440.81607    11.658051    634.90449    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    3000    308.61681   -8022.8579   -929.38792   -1729.5419   -2180.1999   -1532.1732    199.34271   -39.401455    404.04627    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    3200    298.28545   -8083.3107   -2004.2829   -1979.4693   -1734.6035   -1716.4681    96.347125   -303.12919   -536.21524    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    3400    300.24635    -8105.401   -1460.0836   -516.93382    -1410.516   -2523.4388    289.58675   -47.225717   -584.51615    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    3600    303.84026   -8019.5352   -950.35188   -1360.4643   -1972.4299   -1275.8513    63.224972    148.57092    300.93957    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    3800    294.68829   -8046.7354   -1256.7097   -1183.3485    -1146.396   -1989.2399   -256.98822    -744.1009    210.70842    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    4000    296.08091   -8058.0633   -556.38363   -2103.7736   -174.89045   -70.836803    601.28686    141.80637    145.23915    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
Loop time of 68.6074 on 4 procs for 4000 steps with 2565 atoms

Performance: 5.037 ns/day, 4.764 hours/ns, 58.303 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.186     | 29.652     | 30.447     |   8.7 | 43.22
Bond    | 0.13452    | 0.13781    | 0.14171    |   0.9 |  0.20
Kspace  | 12.758     | 13.509     | 13.96      |  12.3 | 19.69
Neigh   | 23.668     | 23.67      | 23.672     |   0.0 | 34.50
Comm    | 1.3558     | 1.3998     | 1.4338     |   2.4 |  2.04
Output  | 0.00070752 | 0.00083968 | 0.0012286  |   0.0 |  0.00
Modify  | 0.12896    | 0.13021    | 0.13089    |   0.2 |  0.19
Other   |            | 0.1077     |            |       |  0.16

Nlocal:    641.25 ave 661 max 624 min
Histogram: 2 0 0 0 0 0 0 1 0 1
Nghost:    8617.5 ave 8729 max 8526 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    296827 ave 309137 max 286703 min
Histogram: 2 0 0 0 0 0 0 1 0 1

Total # of neighbors = 1187307
Ave neighs/atom = 462.888
Ave special neighs/atom = 2
Neighbor list builds = 455
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200

thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] lx ly lz xlo xhi ylo yhi zlo zhi xy xz yz
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no




# Setup MD

timestep ${timestep}
timestep 1
fix 4 all nvt temp 300.0 300.0 100

kspace_style    pppm 1e-6


run ${nrun}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283106
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000290941
  estimated relative force accuracy = 8.76139e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.67 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] Lx Ly Lz Xlo Xhi Ylo Yhi Zlo Zhi Xy Xz Yz 
       0    296.08091   -8058.0633   -556.38363            0            0            0            0            0            0    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     200    307.18452   -8034.3544    695.17949    52.133559   -311.85698    542.47143   -162.14352   -301.71206   -883.61543    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     400    301.01678   -8027.9838   -689.90475   -307.11662    165.68279   -592.16791    32.656254    95.747392     388.7062    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     600     289.9156   -8019.6983    -997.0246   -442.25751    -1541.776    747.78736    16.027298    87.639774   -191.69665    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
     800    305.77484   -8032.9333   -671.03917    -794.4442   -847.17099   -1099.1209   -365.89044    182.30373    396.17503    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1000     306.6913   -8068.2056   -315.26218     -138.684   -1337.9931   -34.341824   -390.27121   -313.17693   -21.222849    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1200    307.15786   -8144.4526    548.68627    578.11616    744.44532    998.55449   -151.25695    614.98377    28.629929    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1400    296.66101   -8051.2183     1101.079    1065.9379    1466.5043   -731.01521   -493.34126    33.409301    160.19086    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1600    294.73452   -8113.7269    1712.8935    1254.3009     1761.041    2533.9516  -0.10707386    -414.7706   -331.43659    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    1800    297.51586   -8052.4402    2270.9149     1867.894    1867.7048    1839.4179    80.680217    503.78461    -385.4752    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
    2000    301.88133   -8025.6408    2036.3324    2577.4712    1414.6969    2004.1579    166.14347     5.482216   -166.43572    29.425907    29.425907    29.425907   -14.712954    14.712954   -14.712954    14.712954   -14.712954    14.712954    1.4712954            0            0 
Loop time of 32.8854 on 4 procs for 2000 steps with 2565 atoms

Performance: 5.255 ns/day, 4.567 hours/ns, 60.817 timesteps/s
97.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.696     | 14.283     | 14.805     |  10.7 | 43.43
Bond    | 0.064398   | 0.066228   | 0.067591   |   0.5 |  0.20
Kspace  | 5.6023     | 6.1035     | 6.6791     |  15.9 | 18.56
Neigh   | 11.644     | 11.646     | 11.647     |   0.0 | 35.41
Comm    | 0.64608    | 0.66865    | 0.68413    |   1.9 |  2.03
Output  | 0.00035068 | 0.00041685 | 0.00061414 |   0.0 |  0.00
Modify  | 0.063178   | 0.064075   | 0.064673   |   0.2 |  0.19
Other   |            | 0.05388    |            |       |  0.16

Nlocal:    641.25 ave 662 max 620 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Nghost:    8622.75 ave 8683 max 8561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:    296715 ave 306955 max 286162 min
Histogram: 1 0 1 0 0 0 0 1 0 1

Total # of neighbors = 1186859
Ave neighs/atom = 462.713
Ave special neighs/atom = 2
Neighbor list builds = 228
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8025.64076287131
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 2036.33237278218
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 2707.14218940859
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1834.48855084944
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1567.36637808852
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 823.45508515641
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 321.388192507337
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -962.438733449593

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -1.8800048858241
variable C2pos equal ${d2}
variable C2pos equal -1.65911677284266
variable C3pos equal ${d3}
variable C3pos equal -1.2438161025785
variable C4pos equal ${d4}
variable C4pos equal 2.34069863350444
variable C5pos equal ${d5}
variable C5pos equal 0.215626120779774
variable C6pos equal ${d6}
variable C6pos equal -1.49073901329075

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-6.2785515400465+${C1pos})
variable C16 equal 0.5*(-6.2785515400465+-1.8800048858241)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-6.1976498872769+${C2pos})
variable C26 equal 0.5*(-6.1976498872769+-1.65911677284266)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-5.19937106603008+${C3pos})
variable C36 equal 0.5*(-5.19937106603008+-1.2438161025785)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-0.89435932594766+${C4pos})
variable C46 equal 0.5*(-0.89435932594766+2.34069863350444)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-0.69910133033047+${C5pos})
variable C56 equal 0.5*(-0.69910133033047+0.215626120779774)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(0.679768373241986+${C6pos})
variable C66 equal 0.5*(0.679768373241986+-1.49073901329075)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 1.04087769918945
variable C22all equal ${C22}
variable C22all equal 0.401265865263305
variable C33all equal ${C33}
variable C33all equal 2.53169438808038

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-0.38888902187127+${C21})
variable C12all equal 0.5*(-0.38888902187127+-2.31185421392134)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(1.54060206475603+${C31})
variable C13all equal 0.5*(1.54060206475603+0.04245052952377)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(2.91455815980703+${C32})
variable C23all equal 0.5*(2.91455815980703+0.0956516778828801)

variable C44all equal ${C44}
variable C44all equal -0.316876377303654
variable C55all equal ${C55}
variable C55all equal -1.08385538759994
variable C66all equal ${C66}
variable C66all equal -0.405485320024382

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-1.12092584221007+${C41})
variable C14all equal 0.5*(-1.12092584221007+-1.6759630558163)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(0.52604282337398+${C51})
variable C15all equal 0.5*(0.52604282337398+0.0707536609079675)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-4.0792782129353+${C61})
variable C16all equal 0.5*(-4.0792782129353+0.211949484413118)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-3.3046084824814+${C42})
variable C24all equal 0.5*(-3.3046084824814+-0.444303125292065)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-0.250255913459318+${C52})
variable C25all equal 0.5*(-0.250255913459318+-0.195630095725944)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-3.92838333005978+${C62})
variable C26all equal 0.5*(-3.92838333005978+0.434316922796879)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-1.40177803418857+${C43})
variable C34all equal 0.5*(-1.40177803418857+1.87624549374305)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-0.820154653396926+${C53})
variable C35all equal 0.5*(-0.820154653396926+0.286509095297504)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-3.22159358430429+${C63})
variable C36all equal 0.5*(-3.22159358430429+-1.56020506520603)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-0.061213009302553+${C54})
variable C45all equal 0.5*(-0.061213009302553+-1.71156586966052)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(0.72316965377839+${C64})
variable C46all equal 0.5*(0.72316965377839+1.23242990077902)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-0.241737604775348+${C65})
variable C56all equal 0.5*(-0.241737604775348+0.618137332059849)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (1.04087769918945+${C22all}+${C33all})/3.0
variable C11cubic equal (1.04087769918945+0.401265865263305+${C33all})/3.0
variable C11cubic equal (1.04087769918945+0.401265865263305+2.53169438808038)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (-1.3503716178963+${C13all}+${C23all})/3.0
variable C12cubic equal (-1.3503716178963+0.7915262971399+${C23all})/3.0
variable C12cubic equal (-1.3503716178963+0.7915262971399+1.50510491884496)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (-0.316876377303654+${C55all}+${C66all})/3.0
variable C44cubic equal (-0.316876377303654+-1.08385538759994+${C66all})/3.0
variable C44cubic equal (-0.316876377303654+-1.08385538759994+-0.405485320024382)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (1.32461265084438+2*${C12cubic})/3.0
variable bulkmodulus equal (1.32461265084438+2*0.31541986602952)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal -0.602072361642659
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (1.32461265084438-${C12cubic})/2.0
variable shearmodulus2 equal (1.32461265084438-0.31541986602952)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+1.32461265084438/${C12cubic})
variable poissonratio equal 1.0/(1.0+1.32461265084438/0.31541986602952)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 1.04087769918945 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 0.401265865263305 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 2.53169438808038 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = -1.3503716178963 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 0.7915262971399 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 1.50510491884496 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = -0.316876377303654 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = -1.08385538759994 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = -0.405485320024382 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = -1.39844444901318 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = 0.298398242140974 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = -1.93366436426109 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = -1.87445580388673 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = -0.222943004592631 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = -1.74703320363145 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 0.23723372977724 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = -0.266822779049711 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = -2.39089932475516 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = -0.886389439481536 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = 0.977799777278705 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = 0.18819986364225 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 0.651817460967807 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = -0.602072361642659 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 0.50459639240743 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.192325373298542
Total wall time: 0:21:42
