LAMMPS (20 Nov 2019)
# Compute elastic constant tensor for a crystal at finite temperature
#
# WARNING: This script attempts to measure small differences in
# statistical averages generated by finite temperature MD simulations.
# This creates many more opportunities for errors to occur, compared
# to the zero temperature version provided in examples/ELASTIC.
# Hence, it is always a good idea to start with the zero temperature
# calculation, before attempting to use this script.
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, MD parameters, deformation parameters,
#		  and initial configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the MD sampling of stress components
#  is generating accurate statistical averages.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to
#  check for finite size effects.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 2.0e-2

# metal units, elastic constants in GPa
##### units		metal

variable cfac equal 4.34e-6

variable cunits string GPa

# Define MD parameters
variable nevery equal 20                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 20*${nrepeat} 
variable nfreq equal 20*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 200           
variable nequil equal 10*${nthermo}       # length of equilibration run
variable nequil equal 10*200       
variable nrun equal 3*${nthermo}          # length of equilibrated run
variable nrun equal 3*200          
variable timestep equal 0.01	           # timestep
variable adiabatic equal 0                # adiabatic (1) or isothermal (2)
variable tdamp equal 0.01                 # time constant for thermostat
variable temp equal 303.15                # temperature of initial sample
variable seed equal 123457                # seed for thermostat



units           real
boundary        p p p

newton          off
pair_style      lj/charmmfsw/coul/long 10 12
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
pair_modify     mix arithmetic
kspace_style    pppm 1e-6

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmmfsw
special_bonds   charmm
improper_style  harmonic

read_data       sys_after_npt.data
  orthogonal box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713)
  1 by 2 by 2 MPI processor grid
  reading atoms ...
  2565 atoms
  reading velocities ...
  2565 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  reading bonds ...
  1710 bonds
  reading angles ...
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000374681 secs
  read_data CPU = 0.0114896 secs
change_box	all triclinic
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)



# Compute initial state

variable thermostat equal 1
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284191
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000266004
  estimated relative force accuracy = 8.01046e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton off
      pair build: half/nsq/newtoff
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 11.05 | 11.15 | 11.44 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    208.29218   -8327.9902    22239.333            0            0            0            0            0            0 
     200    303.66285   -8321.2067    23404.231    22464.948    23228.096    24798.678    683.05285   -98.766893    225.26494 
     400    308.81066   -8317.4411    23302.372     22459.41    23060.034    24478.746    757.55255   -122.48855    210.84657 
     600    307.90045   -8316.5261    22960.494    22139.326    22625.862    24305.443    796.48378    -220.1757    217.96699 
     800    307.66412   -8317.0099    22477.821    21765.302    22241.424    23993.587     778.0574   -175.33798    260.86373 
    1000    299.37057   -8313.8068    22071.887    21534.147    21726.197    23567.116    765.77368   -121.95403    309.27118 
    1200    307.47426   -8310.5257    21992.913    21257.406    21505.936    23322.989    663.73794   -53.985356    196.15152 
    1400    298.56958   -8307.7456    21748.007    21297.377    21301.444     23080.84    666.85435   -65.074378    168.76928 
    1600    304.27295   -8305.4611    21727.758    21064.334    21362.347    22877.473     641.8106   -19.773708    35.450022 
    1800    301.83563   -8303.0721    21431.382    20798.006    21086.486     22750.27    628.58725   -1.8501534     118.4881 
    2000     307.5534   -8297.2528     21299.12    20486.106    21003.407    22661.935    673.15538   -31.859308   -178.79491 
Loop time of 26.5472 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.065 ns/day, 368.712 hours/ns, 75.337 timesteps/s
97.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.139     | 19.838     | 20.433     |  10.4 | 74.73
Bond    | 0.065616   | 0.066391   | 0.067161   |   0.3 |  0.25
Kspace  | 5.6337     | 6.223      | 6.9107     |  18.4 | 23.44
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.25289    | 0.25322    | 0.25347    |   0.0 |  0.95
Output  | 0.00028492 | 0.00033529 | 0.00048071 |   0.0 |  0.00
Modify  | 0.076331   | 0.07732    | 0.077698   |   0.2 |  0.29
Other   |            | 0.08905    |            |       |  0.34

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 2 0 1
Nghost:    8576.5 ave 8623 max 8530 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Neighs:    488652 ave 497635 max 477529 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1954606
Ave neighs/atom = 762.03
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

if "${adiabatic} == 1" then "variable thermostat equal 0" else "variable thermostat equal 1"
variable thermostat equal 1

print ${thermostat}
print 1
1

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284191
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000266004
  estimated relative force accuracy = 8.01046e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 11.05 | 11.15 | 11.44 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0     307.5534   -8297.2528     21299.12            0            0            0            0            0            0 
     200    300.36534   -8282.5603    21048.512    20315.734    20723.295    22348.704    712.66103    80.724696   -197.64259 
     400     309.7996   -8270.2257    20881.712    20113.122    20614.998    22009.515    746.34367    118.76926   -147.34288 
     600    303.92873   -8261.8984    20413.819    19772.705    20218.529    21752.473    769.96693    31.052671   -126.68274 
Loop time of 7.49949 on 4 procs for 600 steps with 2565 atoms

Performance: 0.069 ns/day, 347.198 hours/ns, 80.005 timesteps/s
97.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.6233     | 5.7399     | 5.8008     |   2.9 | 76.54
Bond    | 0.019007   | 0.019155   | 0.019272   |   0.1 |  0.26
Kspace  | 1.5656     | 1.6256     | 1.736      |   5.2 | 21.68
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.073777   | 0.074171   | 0.074612   |   0.1 |  0.99
Output  | 8.0158e-05 | 9.591e-05  | 0.00014154 |   0.0 |  0.00
Modify  | 0.022408   | 0.022578   | 0.022659   |   0.1 |  0.30
Other   |            | 0.018      |            |       |  0.24

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8580 ave 8630 max 8531 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Neighs:    488706 ave 497702 max 477524 min
Histogram: 1 0 0 0 0 0 2 0 0 1

Total # of neighbors = 1954823
Ave neighs/atom = 762.114
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

variable pxx0 equal f_avp[1]
variable pyy0 equal f_avp[2]
variable pzz0 equal f_avp[3]
variable pxy0 equal f_avp[4]
variable pxz0 equal f_avp[5]
variable pyz0 equal f_avp[6]

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 29.4259070715506
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 29.4259070715506
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 29.4259070715506

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-19772.7050439629)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-19772.7050439629)/(v_delta/v_len0)*4.34e-06
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-20218.5294396617)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-20218.5294396617)/(v_delta/v_len0)*4.34e-06
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-21752.4731764724)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-21752.4731764724)/(v_delta/v_len0)*4.34e-06
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--126.682740679278)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--126.682740679278)/(v_delta/v_len0)*4.34e-06
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-31.0526707178242)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-31.0526707178242)/(v_delta/v_len0)*4.34e-06
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-769.966931924245)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-769.966931924245)/(v_delta/v_len0)*4.34e-06

# Write restart
write_restart restart.equil
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284191
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000266004
  estimated relative force accuracy = 8.01046e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 29.4259070715506
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000242037 secs
  read_restart CPU = 0.000982141 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.588518141431012 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.588518141431012 xy delta -0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.588518141431012 xy delta -0 xz delta -0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.1244 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (14.1244 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (14.1244 14.713 14.713) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284532
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000261249
  estimated relative force accuracy = 7.86724e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8066.8001    32349.546            0            0            0            0            0            0 
     200    300.36316   -8037.0115    32030.906    41338.514    26885.855    28269.482    1093.7113   -10.995369   -189.58852 
     400    309.80285   -8010.6682    31747.641    40974.187     26682.63    27834.537    1124.7976    31.669722   -137.00309 
     600    303.93133   -7992.1366    31163.902    40466.979    26190.564    27486.561    1146.3545   -58.285704   -114.09411 
     800    302.96096   -7989.1861    30739.696     39964.92    25702.875     27200.66     1164.507   -7.6557718   -117.49068 
    1000    304.83338   -7983.3312    30485.928    39566.369    25356.689    26897.198    1181.8997   -51.240482   -34.453542 
    1200    309.21284   -7978.4051    30221.534    39101.818    25045.812     26549.44    1091.8157    -10.71744    -53.72272 
    1400    303.07103   -7969.6544    29920.771     39010.86    24868.079    26301.913    1025.5833   -12.171388   -8.5814938 
    1600     304.6301   -7961.1496    29632.569    38540.377    24618.593    25962.371    1031.8912   -52.214588   -8.0505194 
    1800    304.17374   -7959.0652    29358.652     38175.27    24315.728    25866.583    1083.9727   -33.805563      71.4268 
    2000    311.83203   -7943.3957    29383.329    37895.669    24249.097    25921.304    1122.4505   -24.710622    -123.7958 
Loop time of 21.2683 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.081 ns/day, 295.393 hours/ns, 94.037 timesteps/s
96.3% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.595     | 14.276     | 14.606     |  10.6 | 67.12
Bond    | 0.06538    | 0.068459   | 0.070791   |   0.8 |  0.32
Kspace  | 5.8883     | 6.1936     | 6.863      |  15.7 | 29.12
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.56734    | 0.59273    | 0.60818    |   2.0 |  2.79
Output  | 0.00028411 | 0.00034861 | 0.00053684 |   0.0 |  0.00
Modify  | 0.0784     | 0.079438   | 0.080495   |   0.3 |  0.37
Other   |            | 0.05825    |            |       |  0.27

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8652.25 ave 8704 max 8603 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    302888 ave 308869 max 295558 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1211551
Ave neighs/atom = 472.34
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284532
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000261249
  estimated relative force accuracy = 7.86724e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.83203   -7943.3957    29383.329            0            0            0            0            0            0 
     200    299.93913   -7918.7358    29018.786    37661.222    23963.317    25697.643    1248.1394   -26.102045   -250.34662 
     400    311.60761   -7894.3867    28981.308    37430.626    23875.066    25570.447    1274.2647   -32.969007   -256.52661 
     600    306.23845   -7873.7179    28482.748    37020.098    23451.476    25421.588    1283.2771   -130.12288   -280.57534 
Loop time of 6.39397 on 4 procs for 600 steps with 2565 atoms

Performance: 0.081 ns/day, 296.017 hours/ns, 93.838 timesteps/s
96.2% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.1275     | 4.28       | 4.4392     |   5.7 | 66.94
Bond    | 0.019649   | 0.020301   | 0.02084    |   0.3 |  0.32
Kspace  | 1.7135     | 1.8748     | 2.0252     |   8.6 | 29.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.17385    | 0.17707    | 0.17983    |   0.6 |  2.77
Output  | 8.5568e-05 | 0.00010272 | 0.00015046 |   0.0 |  0.00
Modify  | 0.023416   | 0.023796   | 0.023984   |   0.1 |  0.37
Other   |            | 0.01789    |            |       |  0.28

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8654.25 ave 8704 max 8604 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    302877 ave 308845 max 296010 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1211509
Ave neighs/atom = 472.323
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 3.74268422563284
variable C2neg equal ${d2}
variable C2neg equal 0.701549427252161
variable C3neg equal ${d3}
variable C3neg equal 0.79619787035149
variable C4neg equal ${d4}
variable C4neg equal -0.033394693678863
variable C5neg equal ${d5}
variable C5neg equal -0.0349750937038776
variable C6neg equal ${d6}
variable C6neg equal 0.111388314172543

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000252938 secs
  read_restart CPU = 0.00110358 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.588518141431012 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.588518141431012 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.588518141431012 xy delta 0 xz delta 0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (15.3015 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (15.3015 14.713 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (15.3015 14.713 14.713) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283828
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00027139
  estimated relative force accuracy = 8.17264e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.38 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8298.0505    9139.3999            0            0            0            0            0            0 
     200    300.33701   -8291.4457    8850.4566   -1555.7358     13381.72    15101.763     548.7152    55.081273   -76.602971 
     400    309.80179   -8289.2559    8781.6161   -1568.1418    13158.488    14750.468    607.74321   -13.388071   -45.901279 
     600     303.8955   -8281.3268    8630.9982   -1730.5781    12821.204    14703.801    548.86753   -72.610839   -81.384334 
     800    302.95469   -8273.5659    8512.7601   -1637.1084    12724.851    14537.374    659.78655   -28.506176   -52.621615 
    1000    304.83177   -8268.2253    8437.1643   -1499.8089     12524.65    14392.491    792.26181    -193.7668    -21.61374 
    1200    309.27459   -8262.3542    8461.7191   -1648.8629    12453.344    14312.131    820.15257   -118.94477   -78.320888 
    1400    303.07813   -8259.8413    8158.9251   -1620.7036    12337.241    14204.616    865.19366   -104.52712   -69.032607 
    1600     304.6674   -8256.7975    8184.3461   -1741.0271    12071.667    14021.728    827.79289   -43.409787    12.286279 
    1800    304.23414   -8255.4113    8202.3226   -1610.8256    12056.983    14090.248    871.15614   -40.058299    155.60012 
    2000     311.8226   -8251.3303    8393.1414   -1423.8318    12062.351    14165.118    854.27674    40.022155    108.39565 
Loop time of 20.0803 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.086 ns/day, 278.893 hours/ns, 99.600 timesteps/s
95.9% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.948     | 13.326     | 13.63      |   7.0 | 66.36
Bond    | 0.065967   | 0.06683    | 0.067782   |   0.2 |  0.33
Kspace  | 5.6608     | 5.9786     | 6.3442     |  10.3 | 29.77
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.54699    | 0.57316    | 0.58857    |   2.2 |  2.85
Output  | 0.00027637 | 0.00033126 | 0.00049007 |   0.0 |  0.00
Modify  | 0.076332   | 0.0781     | 0.079275   |   0.4 |  0.39
Other   |            | 0.05696    |            |       |  0.28

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8485.75 ave 8538 max 8434 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    290965 ave 296797 max 283880 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1163860
Ave neighs/atom = 453.747
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283828
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00027139
  estimated relative force accuracy = 8.17264e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.38 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0     311.8226   -8251.3303    8393.1414            0            0            0            0            0            0 
     200    301.76916   -8236.8009    8177.7781   -1239.1949    11916.655    14080.617    860.31503    31.622175    146.78764 
     400    305.78437   -8225.5244    8098.4827   -1298.8968    11696.889    13894.534    985.92621   -99.886445     102.8943 
     600    300.23906   -8211.5599    7920.2421   -1362.7595    11391.575    13913.055    990.25249   -87.324922   -50.824003 
Loop time of 6.79091 on 4 procs for 600 steps with 2565 atoms

Performance: 0.076 ns/day, 314.394 hours/ns, 88.353 timesteps/s
97.1% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.0385     | 4.303      | 4.5473     |   9.5 | 63.36
Bond    | 0.020624   | 0.021446   | 0.022662   |   0.5 |  0.32
Kspace  | 1.9974     | 2.2325     | 2.4878     |  12.8 | 32.88
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.1798     | 0.19069    | 0.20099    |   1.7 |  2.81
Output  | 8.3399e-05 | 9.6368e-05 | 0.0001348  |   0.0 |  0.00
Modify  | 0.023587   | 0.024685   | 0.025285   |   0.4 |  0.36
Other   |            | 0.0185     |            |       |  0.27

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 0 1 1
Nghost:    8483.75 ave 8535 max 8435 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    290940 ave 296778 max 284354 min
Histogram: 1 0 0 0 0 2 0 0 0 1

Total # of neighbors = 1163758
Ave neighs/atom = 453.707
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8211.55986690432
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 7920.24211850029
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1502.63107875388
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 11506.5242155141
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 13756.8332187406
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1010.11332258159
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -3.27990436180718
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -85.2649638136938

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 4.61674793862954
variable C2pos equal ${d2}
variable C2pos equal 1.89050513364003
variable C3pos equal ${d3}
variable C3pos equal 1.7350538708278
variable C4pos equal ${d4}
variable C4pos equal -0.00898765757983177
variable C5pos equal ${d5}
variable C5pos equal 0.00745016879228001
variable C6pos equal ${d6}
variable C6pos equal -0.0521117667726438

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(3.74268422563284+${C1pos})
variable C11 equal 0.5*(3.74268422563284+4.61674793862954)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(0.701549427252161+${C2pos})
variable C21 equal 0.5*(0.701549427252161+1.89050513364003)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(0.79619787035149+${C3pos})
variable C31 equal 0.5*(0.79619787035149+1.7350538708278)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-0.033394693678863+${C4pos})
variable C41 equal 0.5*(-0.033394693678863+-0.00898765757983177)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.0349750937038776+${C5pos})
variable C51 equal 0.5*(-0.0349750937038776+0.00745016879228001)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(0.111388314172543+${C6pos})
variable C61 equal 0.5*(0.111388314172543+-0.0521117667726438)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 29.4259070715506
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000256522 secs
  read_restart CPU = 0.0010171 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.588518141431012 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.588518141431012 yz delta -0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.1244 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.1244 14.713) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284532
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000261249
  estimated relative force accuracy = 7.86724e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8061.7006    32627.581            0            0            0            0            0            0 
     200    300.35431   -8031.7744      32308.3    26445.761    42191.737    28692.421    721.99087    65.713891   -231.68592 
     400    309.79968   -8005.6471    32024.077    26148.789    41918.346    28254.018    755.24231    108.73772   -180.46303 
     600    303.92983   -7986.9022    31441.363    25713.522    41359.856     27905.25     781.6252    17.924639    -158.7824 
     800    302.96159   -7985.5432    31023.605    25280.627    40813.271    27617.731    802.34484    71.218103   -165.42017 
    1000    304.81878   -7978.8484    30768.503    24955.507    40399.899    27312.883    822.82574     27.80299   -83.572331 
    1200    309.21084   -7974.1126    30504.242    24563.306    40017.881    26964.257     735.1731    70.512097   -101.20026 
    1400    303.06204   -7965.4569     30200.31    24547.746    39762.888    26714.495     667.8139    69.114915   -57.483129 
    1600    304.64333   -7956.4987    29909.286    24145.309    39435.881    26371.735    675.84222    28.209205   -59.015178 
    1800    304.18992   -7954.3333    29631.546    23851.567    39058.855    26271.503    728.26806    51.029102    18.311628 
    2000    311.82655   -7938.9652    29654.573    23642.797    38912.328    26321.673    770.63613    61.866206   -174.37663 
Loop time of 22.5849 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.077 ns/day, 313.679 hours/ns, 88.555 timesteps/s
96.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.847     | 14.842     | 15.64      |  17.2 | 65.72
Bond    | 0.067111   | 0.069702   | 0.072515   |   0.8 |  0.31
Kspace  | 6.153      | 6.92       | 7.875      |  24.1 | 30.64
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.57611    | 0.61232    | 0.6567     |   4.3 |  2.71
Output  | 0.00028484 | 0.00035932 | 0.00056501 |   0.0 |  0.00
Modify  | 0.077758   | 0.081352   | 0.084481   |   0.9 |  0.36
Other   |            | 0.05907    |            |       |  0.26

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8697 ave 8747 max 8649 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    302897 ave 308811 max 295587 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1211589
Ave neighs/atom = 472.354
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284532
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000261249
  estimated relative force accuracy = 7.86724e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.82655   -7938.9652    29654.573            0            0            0            0            0            0 
     200    299.93815   -7912.7911    29286.263    23477.716    38558.123    26095.407    899.75073    59.088718   -299.12344 
     400    311.60747   -7889.3151    29247.361    23314.278     38396.83    25965.653    928.03486    51.256288   -304.97499 
     600     306.2372   -7868.5535    28747.888    22972.544    37903.949    25814.647    940.80779   -48.590654   -329.60068 
Loop time of 6.12673 on 4 procs for 600 steps with 2565 atoms

Performance: 0.085 ns/day, 283.645 hours/ns, 97.932 timesteps/s
96.1% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.06       | 4.1663     | 4.2505     |   3.7 | 68.00
Bond    | 0.019711   | 0.020307   | 0.020594   |   0.3 |  0.33
Kspace  | 1.6433     | 1.7243     | 1.8297     |   5.7 | 28.14
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.1717     | 0.1744     | 0.17644    |   0.4 |  2.85
Output  | 8.895e-05  | 0.00010446 | 0.00014616 |   0.0 |  0.00
Modify  | 0.023345   | 0.023432   | 0.023565   |   0.1 |  0.38
Other   |            | 0.01788    |            |       |  0.29

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8694.5 ave 8741 max 8648 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    302913 ave 308821 max 296053 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1211653
Ave neighs/atom = 472.379
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.694364949618694
variable C2neg equal ${d2}
variable C2neg equal 3.83773605843413
variable C3neg equal ${d3}
variable C3neg equal 0.881491630308673
variable C4neg equal ${d4}
variable C4neg equal -0.0440331936629511
variable C5neg equal ${d5}
variable C5neg equal -0.0172826014924104
variable C6neg equal ${d6}
variable C6neg equal 0.0370724670696646

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000227979 secs
  read_restart CPU = 0.000965267 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.588518141431012 yz delta ${deltayz} remap units box
change_box all y delta 0 0.588518141431012 yz delta 0 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 15.3015 14.713) with tilt (0 0 0)
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 15.3015 14.713) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283828
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00027139
  estimated relative force accuracy = 8.17264e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.38 | 10.66 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8300.2251    8889.4078            0            0            0            0            0            0 
     200    300.34269    -8266.632    8710.7291     13047.71   -1451.7063    14750.237    887.98288    142.47643   -148.35451 
     400    309.79661   -8234.0105    8563.5706    12839.103   -1492.6691    14411.393    917.41528    181.78929   -96.472015 
     600    303.91614    -8206.685    8123.1685    12498.325    -1816.178    14153.687     936.0428     95.76883   -74.332251 
     800    302.95468   -8195.5575    7836.5569    12159.921   -2145.6316     13957.97    950.19898    145.92008    -76.47351 
    1000    304.82332   -8185.4947    7718.4918    11924.005   -2331.8539    13744.742    968.21688    103.10895     3.722166 
    1200     309.2379   -8175.0539    7586.2268    11620.426   -2485.4351    13487.688    874.47794    146.74217   -16.902862 
    1400    303.08127   -8163.2344    7423.4488    11680.864   -2500.7136    13325.544     807.2957    147.94132    29.360996 
    1600    304.62114   -8149.4824    7268.5586    11364.836   -2586.7412    13073.548    813.20862    109.54433    29.785737 
    1800    304.17713   -8141.7357    7124.1028    11152.477   -2727.2462    13057.501    864.77192    131.58966    106.73525 
    2000    311.82792   -8124.0546    7271.4299    11020.615   -2633.3327    13184.457    906.33242    139.88355   -84.005114 
Loop time of 21.7838 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.079 ns/day, 302.553 hours/ns, 91.811 timesteps/s
96.7% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.82      | 14.054     | 14.443     |   6.3 | 64.51
Bond    | 0.069708   | 0.070777   | 0.071498   |   0.3 |  0.32
Kspace  | 6.5194     | 6.9132     | 7.1486     |   9.0 | 31.74
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.59428    | 0.60366    | 0.61089    |   0.8 |  2.77
Output  | 0.00028151 | 0.00033736 | 0.00049414 |   0.0 |  0.00
Modify  | 0.080661   | 0.081444   | 0.081932   |   0.2 |  0.37
Other   |            | 0.06059    |            |       |  0.28

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8448 ave 8490 max 8414 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    290959 ave 296864 max 283879 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1163836
Ave neighs/atom = 453.737
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283828
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00027139
  estimated relative force accuracy = 8.17264e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.38 | 10.66 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.82792   -8124.0546    7271.4299            0            0            0            0            0            0 
     200    299.94273   -8096.5156    7041.1758    10933.333   -2761.5664    13043.512    1033.0889    134.84768   -206.42712 
     400    311.59665   -8068.2854      7124.09    10848.278   -2696.4665    12994.247     1062.818    126.55635   -213.04562 
     600    306.24097   -8041.1322     6759.117    10587.512   -2959.0504    12924.131    1069.4168    30.576597   -234.20828 
Loop time of 6.7009 on 4 procs for 600 steps with 2565 atoms

Performance: 0.077 ns/day, 310.227 hours/ns, 89.540 timesteps/s
97.1% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.1052     | 4.2815     | 4.4281     |   6.5 | 63.89
Bond    | 0.020688   | 0.021464   | 0.022383   |   0.5 |  0.32
Kspace  | 2.0347     | 2.1699     | 2.3299     |   8.3 | 32.38
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.17228    | 0.18537    | 0.20261    |   2.8 |  2.77
Output  | 8.8064e-05 | 0.00010261 | 0.00014155 |   0.0 |  0.00
Modify  | 0.023716   | 0.024727   | 0.025778   |   0.5 |  0.37
Other   |            | 0.01787    |            |       |  0.27

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8448 ave 8487 max 8418 min
Histogram: 1 1 0 0 0 1 0 0 0 1
Neighs:    290980 ave 296904 max 284324 min
Histogram: 1 0 0 0 1 0 1 0 0 1

Total # of neighbors = 1163922
Ave neighs/atom = 453.771
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8041.13224420096
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 6759.11702788036
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 10356.7365534913
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -2814.01222310984
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 12734.6267532597
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1235.95408171309
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -77.3889459710649
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -341.899941497727

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 2.04326516243234
variable C2pos equal ${d2}
variable C2pos equal 4.99806154082142
variable C3pos equal ${d3}
variable C3pos equal 1.95687267383716
variable C4pos equal ${d4}
variable C4pos equal 0.0467021325776034
variable C5pos equal ${d5}
variable C5pos equal 0.0235318308214889
variable C6pos equal ${d6}
variable C6pos equal -0.101119211504179

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(0.694364949618694+${C1pos})
variable C12 equal 0.5*(0.694364949618694+2.04326516243234)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(3.83773605843413+${C2pos})
variable C22 equal 0.5*(3.83773605843413+4.99806154082142)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(0.881491630308673+${C3pos})
variable C32 equal 0.5*(0.881491630308673+1.95687267383716)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-0.0440331936629511+${C4pos})
variable C42 equal 0.5*(-0.0440331936629511+0.0467021325776034)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-0.0172826014924104+${C5pos})
variable C52 equal 0.5*(-0.0172826014924104+0.0235318308214889)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.0370724670696646+${C6pos})
variable C62 equal 0.5*(0.0370724670696646+-0.101119211504179)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 29.4259070715506
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000243395 secs
  read_restart CPU = 0.000981538 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.1244) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284532
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000261249
  estimated relative force accuracy = 7.86724e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8048.2283    32745.115            0            0            0            0            0            0 
     200    300.35918   -8019.6347    32426.197    26272.247    27135.598    44276.055    802.80396   -224.01102   -82.742841 
     400    309.79265   -7994.0638    32143.135    25976.309    26930.433    43766.567    834.55287   -180.23364   -32.670766 
     600    303.92859   -7974.2578    31558.296    25540.147     26437.59    43351.418    857.89727   -268.81358    -14.10387 
     800    302.95501   -7970.0725     31132.73    25106.614    25946.495    42995.593    875.80968   -218.44781   -20.664458 
    1000    304.81951   -7964.7506    30879.454    24781.755    25596.582    42622.317    893.31451   -260.04658    59.738664 
    1200     309.2131   -7959.8898    30612.312    24388.643    25279.924    42204.871    800.81659   -214.76361    42.955389 
    1400    303.07856   -7952.2691    30312.514    24374.919    25098.977    41883.438    733.39435   -211.97216    88.920912 
    1600    304.63091   -7943.2506     30022.83    23972.958    24843.563    41477.266    740.08677   -248.52982    85.922047 
    1800    304.18131   -7939.4855    29742.418     23679.24    24535.299    41304.408     792.5316   -224.25447    160.88263 
    2000    311.84124   -7923.6774    29761.716    23471.942    24465.593    41267.745    834.88245   -211.20655   -31.955728 
Loop time of 20.4478 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.085 ns/day, 283.998 hours/ns, 97.810 timesteps/s
95.9% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.456     | 13.89      | 14.296     |  10.9 | 67.93
Bond    | 0.066761   | 0.067398   | 0.068957   |   0.3 |  0.33
Kspace  | 5.361      | 5.7746     | 6.1963     |  16.7 | 28.24
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.56468    | 0.58208    | 0.59326    |   1.5 |  2.85
Output  | 0.00028122 | 0.00034959 | 0.0005502  |   0.0 |  0.00
Modify  | 0.075735   | 0.077133   | 0.079071   |   0.5 |  0.38
Other   |            | 0.05629    |            |       |  0.28

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8678.25 ave 8738 max 8626 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    302855 ave 308843 max 295472 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1211420
Ave neighs/atom = 472.288
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.284532
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000261249
  estimated relative force accuracy = 7.86724e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.68 | 10.68 | 10.68 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.84124   -7923.6774    29761.716            0            0            0            0            0            0 
     200    299.94718   -7898.6743    29394.296    23308.888    24177.692    40967.881     964.9532   -212.32052   -158.02839 
     400    311.59489   -7873.6994    29353.614    23147.521    24088.265    40759.433    995.26241   -218.60277   -166.35199 
     600    306.25096   -7852.4486    28853.191    22803.298    23660.776    40541.609    1005.1974   -315.56977   -193.11772 
Loop time of 5.978 on 4 procs for 600 steps with 2565 atoms

Performance: 0.087 ns/day, 276.759 hours/ns, 100.368 timesteps/s
96.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.9163     | 4.1081     | 4.2927     |   6.8 | 68.72
Bond    | 0.019434   | 0.019988   | 0.020396   |   0.2 |  0.33
Kspace  | 1.4577     | 1.6378     | 1.8227     |  10.5 | 27.40
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.16569    | 0.17241    | 0.17957    |   1.3 |  2.88
Output  | 8.4977e-05 | 0.00010087 | 0.00014845 |   0.0 |  0.00
Modify  | 0.021987   | 0.022723   | 0.023023   |   0.3 |  0.38
Other   |            | 0.01682    |            |       |  0.28

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8680.5 ave 8740 max 8624 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Neighs:    302854 ave 308821 max 295978 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1211417
Ave neighs/atom = 472.287
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.657638685602201
variable C2neg equal ${d2}
variable C2neg equal 0.746967584353325
variable C3neg equal ${d3}
variable C3neg equal 4.07724247485223
variable C4neg equal ${d4}
variable C4neg equal -0.0144163899117899
variable C5neg equal ${d5}
variable C5neg equal -0.0752170686880006
variable C6neg equal ${d6}
variable C6neg equal 0.0510450107798441

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000259109 secs
  read_restart CPU = 0.00103454 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 15.3015) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283828
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00027139
  estimated relative force accuracy = 8.17264e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.38 | 10.66 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8309.9025    8799.8859            0            0            0            0            0            0 
     200    300.33808   -8275.0356    8620.9684    13212.498     13252.35   -388.00951    821.69652    437.02255    -289.1753 
     400    309.80378   -8241.8605    8472.8463    13002.822    13135.397   -648.11893    852.65845    475.51854   -236.30428 
     600    303.91756   -8215.6179    8034.7204    12662.825    12738.712   -831.42181    874.23676    387.16763   -211.18463 
     800    302.96126   -8207.3894    7755.5447    12325.026    12345.977   -951.15524    891.24845      439.863   -213.43624 
    1000    304.82279   -8195.9643     7635.885    12088.743    12088.899    -1088.213    912.30977    395.15165   -131.86631 
    1200    309.23556   -8185.7122    7506.3443    11785.867    11862.835   -1269.3918    823.21803    436.18023   -153.03247 
    1400    303.06475   -8172.8283    7339.9162     11844.62    11767.376   -1352.9661    756.16265    433.41871   -108.51629 
    1600    304.63355   -8159.1109    7183.9275      11528.2    11603.274   -1534.2499    763.61799     390.8432     -106.894 
    1800    304.18552   -8152.9799    7042.3131    11315.894    11387.679   -1470.9036    815.23626    411.54535    -27.54086 
    2000    311.81309   -8135.8165    7192.8556    11182.624    11398.401   -1251.2765    856.78983    417.68674   -218.08325 
Loop time of 21.4546 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.081 ns/day, 297.980 hours/ns, 93.220 timesteps/s
96.4% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.873     | 14.086     | 14.365     |   5.6 | 65.65
Bond    | 0.068537   | 0.069611   | 0.070432   |   0.3 |  0.32
Kspace  | 6.2727     | 6.5592     | 6.7805     |   8.2 | 30.57
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.58912    | 0.60041    | 0.61242    |   1.4 |  2.80
Output  | 0.00030068 | 0.00035864 | 0.0005198  |   0.0 |  0.00
Modify  | 0.079744   | 0.080691   | 0.081829   |   0.3 |  0.38
Other   |            | 0.05866    |            |       |  0.27

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8466.75 ave 8511 max 8427 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    290979 ave 296870 max 283915 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1163917
Ave neighs/atom = 453.769
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283828
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00027139
  estimated relative force accuracy = 8.17264e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.28 | 10.38 | 10.66 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.81309   -8135.8165    7192.8556            0            0            0            0            0            0 
     200    299.93392   -8107.1439    6961.8554    11093.395    11197.156      -1312.4    982.79038    410.98623   -339.26543 
     400    311.60923   -8080.4123    7046.6687    11006.465    11184.336   -1276.9138    1010.6729    401.22972   -343.64253 
     600    306.22727   -8053.7451     6682.586    10747.958    10849.985   -1273.6298    1019.9733    302.42531   -362.75845 
Loop time of 7.26334 on 4 procs for 600 steps with 2565 atoms

Performance: 0.071 ns/day, 336.266 hours/ns, 82.607 timesteps/s
96.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.3984     | 4.6577     | 4.8574     |   9.5 | 64.13
Bond    | 0.023609   | 0.024433   | 0.025438   |   0.5 |  0.34
Kspace  | 2.1394     | 2.3337     | 2.5843     |  12.7 | 32.13
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.18404    | 0.201      | 0.21503    |   2.8 |  2.77
Output  | 8.7717e-05 | 0.00010406 | 0.00014033 |   0.0 |  0.00
Modify  | 0.025808   | 0.02645    | 0.027201   |   0.4 |  0.36
Other   |            | 0.01996    |            |       |  0.27

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8468.75 ave 8511 max 8428 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    290972 ave 296872 max 284346 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1163890
Ave neighs/atom = 453.758
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8053.74505404191
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 6682.58597258415
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 10518.8908241196
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 10964.5463915536
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -1435.67929792068
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1186.95169801904
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 193.500878005763
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -469.387867018612

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 2.008077685706
variable C2pos equal ${d2}
variable C2pos equal 2.00811432143946
variable C3pos equal ${d3}
variable C3pos equal 5.0318290869433
variable C4pos equal ${d4}
variable C4pos equal 0.0743670124156355
variable C5pos equal ${d5}
variable C5pos equal -0.0352512609814827
variable C6pos equal ${d6}
variable C6pos equal -0.0904856942425705

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(0.657638685602201+${C1pos})
variable C13 equal 0.5*(0.657638685602201+2.008077685706)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(0.746967584353325+${C2pos})
variable C23 equal 0.5*(0.746967584353325+2.00811432143946)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(4.07724247485223+${C3pos})
variable C33 equal 0.5*(4.07724247485223+5.0318290869433)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-0.0144163899117899+${C4pos})
variable C43 equal 0.5*(-0.0144163899117899+0.0743670124156355)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-0.0752170686880006+${C5pos})
variable C53 equal 0.5*(-0.0752170686880006+-0.0352512609814827)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(0.0510450107798441+${C6pos})
variable C63 equal 0.5*(0.0510450107798441+-0.0904856942425705)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 29.4259070715506
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.0002565 secs
  read_restart CPU = 0.00108685 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 -0.588518)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28451
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000259038
  estimated relative force accuracy = 7.80068e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8233.9197    20400.397            0            0            0            0            0            0 
     200    300.34848   -8201.8887     20152.59     19489.42    19723.859    21553.625    710.45618     108.2154    7613.6972 
     400    309.80386   -8170.9839    19935.998    19237.663    19563.056    21166.133    743.38995    149.22932    7625.6549 
     600    303.91878   -8147.7646    19423.224    18850.826    19119.391    20861.538    767.49544    61.392549    7610.9331 
     800    302.95386   -8140.7293    19070.457    18466.359    18678.931    20619.116    785.82153    113.63316    7568.1767 
    1000    304.82061   -8131.6638    18884.969    18187.944    18375.508    20360.424    805.51568    68.070476    7610.6681 
    1200    309.22531   -8123.0769    18683.727    17840.399    18103.443    20062.545    714.76058    111.67316    7554.6807 
    1400    303.06941   -8111.8841    18450.612    17862.823    17959.596    19858.796    645.46176    112.38942    7560.3439 
    1600    304.63394   -8100.3247    18228.352    17505.969     17753.24    19560.227    652.75986    72.204257    7519.9642 
    1800     304.1986   -8094.2904     18015.61     17253.73    17490.991    19500.896     703.3867     93.82623    7554.2325 
    2000    311.82089   -8078.4908    18104.284    17083.703    17469.812    19591.533    745.81062     102.2048    7317.0996 
Loop time of 22.2312 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.078 ns/day, 308.767 hours/ns, 89.963 timesteps/s
96.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.25      | 14.49      | 14.711     |   4.4 | 65.18
Bond    | 0.069981   | 0.073353   | 0.075853   |   0.8 |  0.33
Kspace  | 6.6662     | 6.9009     | 7.1472     |   6.5 | 31.04
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.61087    | 0.62361    | 0.64136    |   1.5 |  2.81
Output  | 0.00028485 | 0.0003491  | 0.00053596 |   0.0 |  0.00
Modify  | 0.080715   | 0.081986   | 0.08358    |   0.4 |  0.37
Other   |            | 0.06144    |            |       |  0.28

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8577.75 ave 8627 max 8530 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296829 ave 302649 max 289705 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187315
Ave neighs/atom = 462.891
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28451
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000259038
  estimated relative force accuracy = 7.80068e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.82089   -8078.4908    18104.284            0            0            0            0            0            0 
     200    299.93729   -8052.3513    17806.549     16958.41    17233.897    19406.925    874.63414    97.275454    7154.4894 
     400    311.59785    -8025.211    17827.674    16835.093    17187.099    19316.588     904.7953    89.704718    7107.6831 
     600    306.23887   -8001.2733    17393.828    16533.876    16806.661    19203.891    916.46596   -7.9404913    7044.4205 
Loop time of 6.33059 on 4 procs for 600 steps with 2565 atoms

Performance: 0.082 ns/day, 293.083 hours/ns, 94.778 timesteps/s
96.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.0648     | 4.1927     | 4.3669     |   6.2 | 66.23
Bond    | 0.020959   | 0.02125    | 0.021526   |   0.1 |  0.34
Kspace  | 1.7193     | 1.8916     | 2.0163     |   9.0 | 29.88
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.17583    | 0.18254    | 0.18763    |   1.1 |  2.88
Output  | 8.3755e-05 | 9.9665e-05 | 0.00014715 |   0.0 |  0.00
Modify  | 0.023802   | 0.024014   | 0.024162   |   0.1 |  0.38
Other   |            | 0.01838    |            |       |  0.29

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8578.25 ave 8624 max 8531 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    296838 ave 302687 max 290156 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187352
Ave neighs/atom = 462.905
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.702826004533052
variable C2neg equal ${d2}
variable C2neg equal -0.740375498272882
variable C3neg equal ${d3}
variable C3neg equal -0.553042397154465
variable C4neg equal ${d4}
variable C4neg equal 1.55612940602625
variable C5neg equal ${d5}
variable C5neg equal -0.00846151615332436
variable C6neg equal ${d6}
variable C6neg equal 0.0317902893117182

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000259656 secs
  read_restart CPU = 0.00103644 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0.588518)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283811
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000274526
  estimated relative force accuracy = 8.26707e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8231.6752     20350.51            0            0            0            0            0            0 
     200    300.34813   -8198.9914    20101.388    19472.064    19791.437    21349.283    914.34965    110.64565   -8007.6737 
     400    309.79222   -8169.9113    19887.645    19220.173    19635.289    20963.142    944.11725    151.85139   -7916.6324 
     600    303.92699   -8145.8743     19378.38    18833.066    19194.516    20664.748    964.87528    62.922101     -7857.99 
     800     302.9621   -8139.3113    19027.708    18448.377    18756.395    20427.422    981.40762    114.11047   -7823.8111 
    1000    304.82118   -8130.4363    18841.039    18167.656    18457.965    20171.509    1000.5193    73.393067   -7704.2561 
    1200    309.22321   -8122.7199    18646.928    17821.366    18192.333    19867.196    909.76327    116.10091   -7686.5027 
    1400    303.07342   -8112.2856    18414.825    17845.622    18064.676    19662.504    844.51194    115.24864   -7601.9011 
    1600    304.63004   -8100.0345    18192.471    17485.917    17856.711    19369.633    851.46831    76.215391    -7562.637 
    1800     304.1681   -8095.0733    17984.272    17233.888     17600.45    19315.839    904.94792    99.359035   -7442.3789 
    2000    311.83331   -8076.7615     18066.86    17064.933    17567.712     19405.33     946.4578    109.99347   -7588.6135 
Loop time of 21.4795 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.080 ns/day, 298.326 hours/ns, 93.112 timesteps/s
96.2% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.848     | 14.188     | 14.717     |   8.5 | 66.05
Bond    | 0.069869   | 0.071607   | 0.073858   |   0.5 |  0.33
Kspace  | 5.9402     | 6.4763     | 6.809      |  12.7 | 30.15
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.58506    | 0.6018     | 0.60953    |   1.3 |  2.80
Output  | 0.00029097 | 0.00033996 | 0.00047673 |   0.0 |  0.00
Modify  | 0.079333   | 0.081588   | 0.083379   |   0.6 |  0.38
Other   |            | 0.06001    |            |       |  0.28

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8577.75 ave 8627 max 8530 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296821 ave 302759 max 289657 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187284
Ave neighs/atom = 462.879
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283811
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000274526
  estimated relative force accuracy = 8.26707e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.83331   -8076.7615     18066.86            0            0            0            0            0            0 
     200    299.94321   -8048.1439     17767.34    16939.573    17319.466    19225.962    1073.6825     107.0093   -7673.0342 
     400    311.60609   -8022.5417    17791.374     16816.24    17268.718    19140.356    1101.5451    98.403997   -7638.7335 
     600    306.23884   -7997.5405    17361.903    16516.757    16892.456    19034.977    1109.1228   0.30333004   -7621.0357 
Loop time of 6.16439 on 4 procs for 600 steps with 2565 atoms

Performance: 0.084 ns/day, 285.389 hours/ns, 97.333 timesteps/s
95.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.0113     | 4.1183     | 4.3068     |   5.8 | 66.81
Bond    | 0.020202   | 0.020739   | 0.021621   |   0.4 |  0.34
Kspace  | 1.6193     | 1.8084     | 1.9113     |   8.7 | 29.34
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.17273    | 0.17538    | 0.18024    |   0.7 |  2.85
Output  | 8.7918e-05 | 0.00010375 | 0.00014647 |   0.0 |  0.00
Modify  | 0.023031   | 0.023662   | 0.024186   |   0.3 |  0.38
Other   |            | 0.01785    |            |       |  0.29

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8578.25 ave 8624 max 8531 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    296844 ave 302746 max 290133 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187378
Ave neighs/atom = 462.915
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -7997.54048475319
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 17361.9025237354
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 16266.4562374605
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 16991.889222469
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 18827.3621112768
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1278.57064953951
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -110.192975889553
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -7715.16682572931

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.760855991011021
variable C2pos equal ${d2}
variable C2pos equal 0.700180927130816
variable C3pos equal ${d3}
variable C3pos equal 0.634749101147445
variable C4pos equal ${d4}
variable C4pos equal 1.64670104645586
variable C5pos equal ${d5}
variable C5pos equal 0.0306503053138008
variable C6pos equal ${d6}
variable C6pos equal -0.110367006722512

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-0.702826004533052+${C1pos})
variable C14 equal 0.5*(-0.702826004533052+0.760855991011021)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-0.740375498272882+${C2pos})
variable C24 equal 0.5*(-0.740375498272882+0.700180927130816)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-0.553042397154465+${C3pos})
variable C34 equal 0.5*(-0.553042397154465+0.634749101147445)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(1.55612940602625+${C4pos})
variable C44 equal 0.5*(1.55612940602625+1.64670104645586)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-0.00846151615332436+${C5pos})
variable C54 equal 0.5*(-0.00846151615332436+0.0306503053138008)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(0.0317902893117182+${C6pos})
variable C64 equal 0.5*(0.0317902893117182+-0.110367006722512)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 29.4259070715506
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000246503 secs
  read_restart CPU = 0.00100372 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 -0.588518 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28451
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000259038
  estimated relative force accuracy = 7.80068e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873    -8234.448    20210.575            0            0            0            0            0            0 
     200    300.34685   -8201.0281    19962.815    19216.936    19871.611    21105.873      802.168    7469.3425   -191.12862 
     400    309.79781    -8171.083    19748.959    18966.785    19713.775    20721.565    831.88379    7473.6798   -139.71289 
     600    303.92711   -8148.1495    19238.591    18582.002    19270.345    20420.675     853.7411    7347.5498   -117.28906 
     800    302.95906   -8140.8459     18884.75    18197.034      18831.1    20179.057    871.52301    7359.9043   -121.18996 
    1000    304.82039   -8131.7439    18701.052    17919.269    18528.874    19924.261    891.28871    7278.5166   -42.485974 
    1200    309.22402   -8123.4812    18501.689    17572.972    18258.344    19623.774    799.79418    7285.6348   -60.965309 
    1400    303.07422   -8112.8829    18270.359    17595.688    18119.647    19422.619    730.88457    7249.2476   -14.848166 
    1600    304.63035    -8101.568     18048.44    17239.831    17909.608    19129.744    739.85041    7175.8798   -15.949904 
    1800    304.18282   -8095.5391    17837.442    16987.506    17647.477    19074.739    790.44362    7161.0295    60.706535 
    2000    311.82791   -8078.2139    17925.284    16819.981    17619.534    19168.428    833.71461    7132.0727   -132.14003 
Loop time of 22.1905 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.078 ns/day, 308.202 hours/ns, 90.129 timesteps/s
95.8% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.144     | 14.42      | 14.658     |   4.9 | 64.98
Bond    | 0.071848   | 0.073418   | 0.074808   |   0.4 |  0.33
Kspace  | 6.6803     | 6.9304     | 7.199      |   7.1 | 31.23
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.60877    | 0.62169    | 0.63415    |   1.4 |  2.80
Output  | 0.0003138  | 0.00038875 | 0.00060421 |   0.0 |  0.00
Modify  | 0.082246   | 0.083196   | 0.083866   |   0.2 |  0.37
Other   |            | 0.06177    |            |       |  0.28

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8578.5 ave 8628 max 8531 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296783 ave 302642 max 289636 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187132
Ave neighs/atom = 462.819
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28451
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000259038
  estimated relative force accuracy = 7.80068e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.82791   -8078.2139    17925.284            0            0            0            0            0            0 
     200    299.94237   -8051.0525    17628.776    16696.801    17377.149    18989.818    963.95991     7093.852   -256.43093 
     400    311.60247   -8024.7438    17651.933    16575.731    17327.666    18903.295    993.22002    7047.7435   -262.28026 
     600    306.23489   -8000.9741    17220.627     16276.06    16948.652     18795.85    1001.8301    6912.1856   -284.92864 
Loop time of 7.45638 on 4 procs for 600 steps with 2565 atoms

Performance: 0.070 ns/day, 345.203 hours/ns, 80.468 timesteps/s
96.7% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.2512     | 4.6982     | 5.0264     |  15.0 | 63.01
Bond    | 0.022122   | 0.024049   | 0.02564    |   0.9 |  0.32
Kspace  | 2.1634     | 2.4781     | 2.9057     |  19.6 | 33.23
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.18497    | 0.20858    | 0.23002    |   4.2 |  2.80
Output  | 8.6359e-05 | 0.00010354 | 0.00015091 |   0.0 |  0.00
Modify  | 0.024553   | 0.026449   | 0.028071   |   0.9 |  0.35
Other   |            | 0.02087    |            |       |  0.28

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8580.5 ave 8625 max 8535 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    296786 ave 302627 max 290065 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187143
Ave neighs/atom = 462.824
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.758771982442959
variable C2neg equal ${d2}
variable C2neg equal -0.709563417770121
variable C3neg equal ${d3}
variable C3neg equal -0.641587244308892
variable C4neg equal ${d4}
variable C4neg equal -0.0343393595321277
variable C5neg equal ${d5}
variable C5neg equal 1.49320585084617
variable C6neg equal ${d6}
variable C6neg equal 0.0503143045564926

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000231471 secs
  read_restart CPU = 0.000961298 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0.588518 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283811
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000274526
  estimated relative force accuracy = 8.26707e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8234.5038    20532.279            0            0            0            0            0            0 
     200    300.39197   -8231.6041    20211.598    19267.944    19894.585    21836.342    793.06129   -7443.2829   -101.12119 
     400    309.78547   -8224.9636    20184.815     19187.41    19714.846    21383.052    809.76922   -7438.6301   -126.50362 
     600    303.92337    -8224.109    19962.153     19170.18    19535.447    21361.389    867.68623   -7345.3948   -128.76286 
     800    302.93473   -8220.7481    19743.603    18989.368    19480.223    21116.413    885.78054   -7253.4075    -16.73135 
    1000    304.83392   -8215.6155    19677.338    18937.414    19346.593    20962.769    866.64495   -7277.5272   -29.703433 
    1200    309.25771   -8215.2383     19550.48    18704.573    19067.796    20682.244     915.9807   -7109.8777   -140.97436 
    1400    303.09298   -8216.1274    19216.745    18634.755    19040.609    20531.379    858.61047   -7181.2204   -210.18099 
    1600     304.6553   -8209.0091     19097.72    18373.161    18718.156    20321.733    832.38924   -7216.3804   -185.99728 
    1800    304.18618   -8204.8097    19159.964    18166.376    18772.237      20350.4    773.79713   -7152.3688   -66.021803 
    2000    311.83401   -8201.6709    19032.472    18128.261    18664.831    20255.021    710.03883   -7025.2346   -163.66056 
Loop time of 20.6016 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.084 ns/day, 286.134 hours/ns, 97.080 timesteps/s
96.3% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.966     | 13.735     | 14.246     |  13.2 | 66.67
Bond    | 0.067061   | 0.068761   | 0.071111   |   0.6 |  0.33
Kspace  | 5.5674     | 6.0729     | 6.8192     |  19.4 | 29.48
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.56678    | 0.58335    | 0.60574    |   2.0 |  2.83
Output  | 0.00028138 | 0.00033658 | 0.0004943  |   0.0 |  0.00
Modify  | 0.076972   | 0.081414   | 0.086753   |   1.4 |  0.40
Other   |            | 0.06003    |            |       |  0.29

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8578.5 ave 8628 max 8531 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296808 ave 302669 max 289579 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187231
Ave neighs/atom = 462.858
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283811
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000274526
  estimated relative force accuracy = 8.26707e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.83401   -8201.6709    19032.472            0            0            0            0            0            0 
     200    302.42483   -8188.9218    18626.004    17969.261    18367.515    20043.321    878.98042   -6947.3438   -173.01066 
     400    300.56072   -8180.8723    18485.788    17651.347    18194.613    19799.117    825.02107   -6953.1926    -234.0496 
     600     297.0292   -8175.2749    18156.403    17565.901    17924.054    19685.961    736.71592   -6872.3441   -187.35137 
Loop time of 5.87708 on 4 procs for 600 steps with 2565 atoms

Performance: 0.088 ns/day, 272.087 hours/ns, 102.092 timesteps/s
96.5% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.9433     | 4.0082     | 4.1925     |   5.3 | 68.20
Bond    | 0.019161   | 0.019685   | 0.020529   |   0.4 |  0.33
Kspace  | 1.4588     | 1.6359     | 1.6995     |   8.0 | 27.84
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.16386    | 0.17214    | 0.17804    |   1.2 |  2.93
Output  | 8.3581e-05 | 0.00010032 | 0.00015018 |   0.0 |  0.00
Modify  | 0.022478   | 0.023483   | 0.025315   |   0.7 |  0.40
Other   |            | 0.01754    |            |       |  0.30

Nlocal:    641.25 ave 651 max 626 min
Histogram: 1 0 0 0 0 0 1 0 1 1
Nghost:    8578.5 ave 8621 max 8540 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296835 ave 303184 max 289617 min
Histogram: 1 0 0 0 0 2 0 0 0 1

Total # of neighbors = 1187341
Ave neighs/atom = 462.901
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8175.27494679782
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 18156.4026866278
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 17385.1826742767
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 17646.2711538153
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 19437.7542317912
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 820.327784590365
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -6843.98779733291
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -256.928497572221

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.518092354221905
variable C2pos equal ${d2}
variable C2pos equal 0.558180048028668
variable C3pos equal ${d3}
variable C3pos equal 0.50229401099582
variable C4pos equal ${d4}
variable C4pos equal 0.0282633292457686
variable C5pos equal ${d5}
variable C5pos equal 1.49188378156701
variable C6pos equal ${d6}
variable C6pos equal -0.010928305028548

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-0.758771982442959+${C1pos})
variable C15 equal 0.5*(-0.758771982442959+0.518092354221905)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-0.709563417770121+${C2pos})
variable C25 equal 0.5*(-0.709563417770121+0.558180048028668)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-0.641587244308892+${C3pos})
variable C35 equal 0.5*(-0.641587244308892+0.50229401099582)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-0.0343393595321277+${C4pos})
variable C45 equal 0.5*(-0.0343393595321277+0.0282633292457686)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(1.49320585084617+${C5pos})
variable C55 equal 0.5*(1.49320585084617+1.49188378156701)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(0.0503143045564926+${C6pos})
variable C65 equal 0.5*(0.0503143045564926+-0.010928305028548)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 29.4259070715506

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000305649 secs
  read_restart CPU = 0.00123384 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*29.4259070715506
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (-0.588518 0 0)

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28451
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000259038
  estimated relative force accuracy = 7.80068e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8228.2774    20413.661            0            0            0            0            0            0 
     200    300.35148   -8194.9944    20163.796    19552.971    19831.665    21418.095    8347.0954    94.468388   -295.58695 
     400    309.79956   -8165.6107    19949.857    19301.867    19674.214    21030.116     8339.371    135.41029   -242.92895 
     600    303.92439    -8141.624     19438.45    18913.055    19234.566    20727.633    8326.1111    48.499771   -221.75294 
     800    302.95511   -8134.7048    19087.775    18527.438    18798.235    20487.738    8310.0171    101.89109   -225.65508 
    1000     304.8202   -8125.6187    18901.651    18247.374    18497.865    20228.889    8291.8299    58.504092   -143.42724 
    1200    309.21942   -8118.3019    18704.364    17904.869    18230.879     19926.54    8165.3248    101.82627   -163.98618 
    1400    303.07259   -8108.4299    18474.361    17932.171    18093.719     19721.49    8059.0817    103.12395    -120.3668 
    1600    304.63587     -8095.61    18252.484    17578.072    17887.104     19425.25     8030.498    65.073888   -121.29873 
    1800    304.18354   -8089.6552    18040.298     17326.32    17627.447    19368.101    8047.7839    88.242291   -44.546615 
    2000    311.83253   -8072.5409     18126.26    17154.458    17600.041    19457.709    8052.9362    100.47775     -234.792 
Loop time of 22.1425 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.078 ns/day, 307.535 hours/ns, 90.324 timesteps/s
96.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.326     | 14.53      | 14.697     |   3.6 | 65.62
Bond    | 0.071935   | 0.073486   | 0.074819   |   0.4 |  0.33
Kspace  | 6.5923     | 6.7833     | 6.9789     |   5.3 | 30.63
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.58821    | 0.61089    | 0.63802    |   2.4 |  2.76
Output  | 0.00030341 | 0.00036935 | 0.00055706 |   0.0 |  0.00
Modify  | 0.082392   | 0.083278   | 0.084886   |   0.3 |  0.38
Other   |            | 0.06088    |            |       |  0.27

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8578.5 ave 8628 max 8531 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296815 ave 302652 max 289726 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187260
Ave neighs/atom = 462.869
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.28451
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000259038
  estimated relative force accuracy = 7.80068e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.83253   -8072.5409     18126.26            0            0            0            0            0            0 
     200    299.93593    -8043.788    17823.256    17024.007    17357.604     19275.71    8145.7009    98.533953   -356.70964 
     400    311.59962   -8018.1021    17846.149    16896.468     17306.96    19187.835    8136.0817    91.405692   -362.58132 
     600    306.23319   -7993.1751    17414.691    16595.968    16930.367    19078.069    8114.0792   -4.8335872   -385.53544 
Loop time of 6.03794 on 4 procs for 600 steps with 2565 atoms

Performance: 0.086 ns/day, 279.534 hours/ns, 99.372 timesteps/s
95.9% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.0187     | 4.0815     | 4.2124     |   3.9 | 67.60
Bond    | 0.020167   | 0.020519   | 0.020969   |   0.2 |  0.34
Kspace  | 1.5902     | 1.7192     | 1.784      |   5.9 | 28.47
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.16987    | 0.1744     | 0.17896    |   0.8 |  2.89
Output  | 8.3852e-05 | 9.9254e-05 | 0.00014466 |   0.0 |  0.00
Modify  | 0.023804   | 0.024024   | 0.024298   |   0.1 |  0.40
Other   |            | 0.01818    |            |       |  0.30

Nlocal:    641.25 ave 650 max 627 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    8580.5 ave 8625 max 8535 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    296820 ave 302648 max 290196 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187279
Ave neighs/atom = 462.877
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.689351870427143
variable C2neg equal ${d2}
variable C2neg equal -0.713531214501661
variable C3neg equal ${d3}
variable C3neg equal -0.580345779662905
variable C4neg equal ${d4}
variable C4neg equal -0.0561710348247522
variable C5neg equal ${d5}
variable C5neg equal -0.00778731796771659
variable C6neg equal ${d6}
variable C6neg equal 1.59367235752504

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  restoring atom style full from restart
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0 0 0)
  1 by 2 by 2 MPI processor grid
Switching to CHARMM coulomb energy conversion constant (src/KSPACE/pair_lj_charmmfsw_coul_long.cpp:67)
  restoring pair style lj/charmmfsw/coul/long from restart
  restoring bond style harmonic from restart
  restoring angle style charmm from restart
  restoring dihedral style charmmfsw from restart
  restoring improper style harmonic from restart
  2565 atoms
  1710 bonds
  855 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
  special bonds CPU = 0.000238582 secs
  read_restart CPU = 0.000990765 secs
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*29.4259070715506
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.588518141431012 remap units box
  triclinic box = (-14.713 -14.713 -14.713) to (14.713 14.713 14.713) with tilt (0.588518 0 0)

# Run MD

run ${nequil}
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283811
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000274526
  estimated relative force accuracy = 8.26707e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmmfsw/coul/long, perpetual
      attributes: half, newton on
      pair build: half/nsq/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    303.92873   -8239.4406    20331.585            0            0            0            0            0            0 
     200    300.37117   -8239.4751    20028.215    18946.778    19898.797    21499.557   -6727.8406   -112.43669    46.782209 
     400    309.79158   -8237.1319    19971.298    18925.454    19712.614    21060.302   -6617.4653   -177.21657    93.197287 
     600    303.89691   -8230.4472    19806.609    18955.844    19500.731    21157.272   -6621.3828    -255.9589    150.13904 
     800    302.95408   -8228.2425    19550.926    18779.689     19327.77    20943.992   -6616.2979   -210.61676    264.01687 
    1000    304.86765   -8222.3905    19447.823    18637.045    19059.405    20690.261   -6642.3725   -176.72697     254.4683 
    1200    309.27063   -8218.7496    19331.714    18431.521    18831.587    20654.013   -6564.6204   -123.88249    158.73222 
    1400    303.08663    -8221.817     19030.82    18237.129    18710.577    20477.094   -6420.9493   -229.03972    33.400838 
    1600    304.67226   -8217.5209    18932.966     17980.41    18459.727    20400.921   -6348.2022   -239.77244    35.846008 
    1800    304.22303   -8211.9324    18822.724    17853.447    18395.618    20336.688    -6276.679   -152.59943    169.23472 
    2000    311.82863   -8209.4437    18843.811    17878.341    18171.395     20212.23   -6124.0828   -105.94871   -5.0836603 
Loop time of 20.677 on 4 procs for 2000 steps with 2565 atoms

Performance: 0.084 ns/day, 287.180 hours/ns, 96.726 timesteps/s
96.4% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.074     | 13.711     | 14.151     |  10.8 | 66.31
Bond    | 0.068082   | 0.069321   | 0.070656   |   0.3 |  0.34
Kspace  | 5.7214     | 6.166      | 6.794      |  16.0 | 29.82
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.58357    | 0.58982    | 0.59948    |   0.9 |  2.85
Output  | 0.00029157 | 0.00034683 | 0.00050468 |   0.0 |  0.00
Modify  | 0.077444   | 0.080812   | 0.085648   |   1.1 |  0.39
Other   |            | 0.05948    |            |       |  0.29

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8578.5 ave 8628 max 8531 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296849 ave 302727 max 289659 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187397
Ave neighs/atom = 462.923
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  20 10 200 c_thermo_press mode vector
thermo		${nthermo}
thermo		200
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:708)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.01
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 ${temp} ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 ${tdamp} ${seed}
fix 5 all langevin 303.15 303.15 0.01 ${seed}
fix 5 all langevin 303.15 303.15 0.01 123457

kspace_style    pppm 1e-6
run ${nrun}
run 600
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:323)
  G vector (1/distance) = 0.283811
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.000274526
  estimated relative force accuracy = 8.26707e-07
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Per MPI rank memory allocation (min/avg/max) = 10.29 | 10.58 | 10.67 Mbytes
Step Temp PotEng Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] 
       0    311.82863   -8209.4437    18843.811            0            0            0            0            0            0 
     200    300.35619   -8188.8433    18381.501    17616.328    17863.474    20014.821   -5986.3891   -159.98862    53.488645 
     400    309.78388   -8170.1053    18275.278    17545.453    17611.675    19510.065   -5873.6301   -203.04408    95.309023 
     600    303.88757   -8146.7212    18086.134    17544.468    17371.221    19563.736    -5870.968   -278.92876     154.5741 
Loop time of 6.00799 on 4 procs for 600 steps with 2565 atoms

Performance: 0.086 ns/day, 278.148 hours/ns, 99.867 timesteps/s
96.4% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.9176     | 4.0321     | 4.1913     |   5.3 | 67.11
Bond    | 0.020101   | 0.020353   | 0.020883   |   0.2 |  0.34
Kspace  | 1.5798     | 1.7358     | 1.8443     |   7.9 | 28.89
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.17325    | 0.17701    | 0.1831     |   0.9 |  2.95
Output  | 8.3616e-05 | 9.953e-05  | 0.00014618 |   0.0 |  0.00
Modify  | 0.023215   | 0.024121   | 0.025463   |   0.6 |  0.40
Other   |            | 0.01853    |            |       |  0.31

Nlocal:    641.25 ave 650 max 626 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Nghost:    8576.75 ave 8627 max 8529 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:    296850 ave 302704 max 289674 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 1187398
Ave neighs/atom = 462.923
Ave special neighs/atom = 2
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -8146.72122143379
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 18086.1341029423
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 17478.6391213449
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 17364.3686823539
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 19415.3945051282
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -5827.69426350616
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -295.44072119042
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 132.3534039429

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.497812305208106
variable C2pos equal ${d2}
variable C2pos equal 0.619352884335792
variable C3pos equal ${d3}
variable C3pos equal 0.507146071681691
variable C4pos equal ${d4}
variable C4pos equal -0.0562108433830126
variable C5pos equal ${d5}
variable C5pos equal 0.070849066044089
variable C6pos equal ${d6}
variable C6pos equal 1.4316924794084

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-0.689351870427143+${C1pos})
variable C16 equal 0.5*(-0.689351870427143+0.497812305208106)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-0.713531214501661+${C2pos})
variable C26 equal 0.5*(-0.713531214501661+0.619352884335792)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-0.580345779662905+${C3pos})
variable C36 equal 0.5*(-0.580345779662905+0.507146071681691)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-0.0561710348247522+${C4pos})
variable C46 equal 0.5*(-0.0561710348247522+-0.0562108433830126)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-0.00778731796771659+${C5pos})
variable C56 equal 0.5*(-0.00778731796771659+0.070849066044089)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(1.59367235752504+${C6pos})
variable C66 equal 0.5*(1.59367235752504+1.4316924794084)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 4.17971608213119
variable C22all equal ${C22}
variable C22all equal 4.41789879962777
variable C33all equal ${C33}
variable C33all equal 4.55453578089776

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(1.36881505602552+${C21})
variable C12all equal 0.5*(1.36881505602552+1.2960272804461)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(1.3328581856541+${C31})
variable C13all equal 0.5*(1.3328581856541+1.26562587058965)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(1.37754095289639+${C32})
variable C23all equal 0.5*(1.37754095289639+1.41918215207292)

variable C44all equal ${C44}
variable C44all equal 1.60141522624106
variable C55all equal ${C55}
variable C55all equal 1.49254481620659
variable C66all equal ${C66}
variable C66all equal 1.51268241846672

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(0.0290149932389845+${C41})
variable C14all equal 0.5*(0.0290149932389845+-0.0211911756293474)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-0.120339814110527+${C51})
variable C15all equal 0.5*(-0.120339814110527+-0.0137624624557988)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-0.0957697826095185+${C61})
variable C16all equal 0.5*(-0.0957697826095185+0.0296382736999496)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-0.020097285571033+${C42})
variable C24all equal 0.5*(-0.020097285571033+0.00133446945732615)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-0.0756916848707265+${C52})
variable C25all equal 0.5*(-0.0756916848707265+0.00312461466453925)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-0.0470891650829345+${C62})
variable C26all equal 0.5*(-0.0470891650829345+-0.0320233722172572)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(0.04085335199649+${C43})
variable C34all equal 0.5*(0.04085335199649+0.0299753112519228)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-0.069646616656536+${C53})
variable C35all equal 0.5*(-0.069646616656536+-0.0552341648347417)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-0.036599853990607+${C63})
variable C36all equal 0.5*(-0.036599853990607+-0.0197203417313632)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-0.00303801514317955+${C54})
variable C45all equal 0.5*(-0.00303801514317955+0.0110943945802382)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-0.0561909391038824+${C64})
variable C46all equal 0.5*(-0.0561909391038824+-0.0392883587053969)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(0.0315308740381862+${C65})
variable C56all equal 0.5*(0.0315308740381862+0.0196929997639723)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (4.17971608213119+${C22all}+${C33all})/3.0
variable C11cubic equal (4.17971608213119+4.41789879962777+${C33all})/3.0
variable C11cubic equal (4.17971608213119+4.41789879962777+4.55453578089776)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (1.33242116823581+${C13all}+${C23all})/3.0
variable C12cubic equal (1.33242116823581+1.29924202812188+${C23all})/3.0
variable C12cubic equal (1.33242116823581+1.29924202812188+1.39836155248465)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (1.60141522624106+${C55all}+${C66all})/3.0
variable C44cubic equal (1.60141522624106+1.49254481620659+${C66all})/3.0
variable C44cubic equal (1.60141522624106+1.49254481620659+1.51268241846672)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (4.38405022088557+2*${C12cubic})/3.0
variable bulkmodulus equal (4.38405022088557+2*1.34334158294745)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 1.53554748697146
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (4.38405022088557-${C12cubic})/2.0
variable shearmodulus2 equal (4.38405022088557-1.34334158294745)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+4.38405022088557/${C12cubic})
variable poissonratio equal 1.0/(1.0+4.38405022088557/1.34334158294745)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 4.17971608213119 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 4.41789879962777 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 4.55453578089776 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 1.33242116823581 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 1.29924202812188 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 1.39836155248465 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 1.60141522624106 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 1.49254481620659 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 1.51268241846672 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = 0.00391190880481855 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = -0.0670511382831629 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = -0.0330657544547844 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = -0.00938140805685343 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = -0.0362835351030936 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = -0.0395562686500959 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 0.0354143316242064 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = -0.0624403907456389 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = -0.0281600978609851 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = 0.00402818971852933 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = -0.0477396489046397 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = 0.0256119369010792 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 2.35691112892682 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 1.53554748697146 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 1.52035431896906 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.234546828461854
Total wall time: 0:06:10
