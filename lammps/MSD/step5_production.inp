variable        dcdfreq index 500


units           real
boundary        p p p

newton          off
pair_style      lj/charmmfsw/coul/long 10 12
pair_modify     mix arithmetic
kspace_style    pppm 1e-6

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmmfsw
special_bonds   charmm
improper_style  harmonic


read_data       sys_after_npt.data

#variable        laststep file sys_after_min.dump
#next            laststep
#read_dump       sys_after_min.dump ${laststep}  x y z vx vy vz ix iy iz box yes replace yes format native

neighbor        2 bin
neigh_modify    delay 5 every 1

#include         restraints/constraint_angletype
#fix             1 all shake 1e-6 500 0 m 1.008 a ${constraint_angletype}

fix             2 all npt temp 303.15 303.15 100.0 iso   0.9869233 0.9869233 1000 couple  xyz mtk no pchain 0


compute	msd all msd com yes

# factor of 6 in 2 variables is for 3d
variable        twopoint equal c_msd[4]/6/(step*dt+1.0e-6)
fix             9 all vector 10 c_msd[4]
variable        fitslope equal slope(f_9)/6/(10*dt)


thermo          ${dcdfreq}
thermo_style    custom step time etotal pe ke temp press temp vol c_msd[4] v_twopoint v_fitslope cpuremain




timestep        1
run             50000

